<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Inspection - CheckMate Virtue</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .status-pass { color: #28a745; }
        .status-recommended { color: #ffc107; }
        .status-required { color: #dc3545; }
        .step-header { background-color: #f8f9fa; }
        .subcategory-header { background-color: #e9ecef; }
        .item-row { border-bottom: 1px solid #dee2e6; }
        .photo-preview { max-width: 150px; max-height: 150px; }
        .progress-bar { height: 8px; }
        .vehicle-info-card { 
            background-color: #f8f9fa; 
            border: 1px solid #dee2e6; 
            border-radius: 0.375rem; 
            padding: 1rem; 
        }
        .vehicle-info-item { 
            margin-bottom: 0.5rem; 
            font-size: 0.875rem; 
        }
        .inspector-info-card {
            background-color: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 0.375rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        .validation-error {
            display: none;
            margin-bottom: 1rem;
        }
        .field-error {
            border-color: #dc3545 !important;
            box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25) !important;
        }
        
        .status-checkboxes {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .status-checkboxes .form-check-inline {
            margin-right: 0.5rem;
        }
        
        .status-checkboxes .form-check-input {
            margin-right: 0.25rem;
        }
        
        .status-checkboxes .form-check-label {
            font-size: 0.875rem;
            cursor: pointer;
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mt-2{margin-top:0.5rem}.mt-1{margin-top:0.25rem}.table{display:table}.rounded{border-radius:0.25rem}.border-2{border-width:2px}.border-dashed{border-style:dashed}.p-3{padding:0.75rem}.p-4{padding:1rem}.text-center{text-align:center}.text-start{text-align:start}</style></head>
<body>
    <div class="container-fluid">
        <!-- Validation Error Container -->
        <div id="validation-error-container" data-testid="validation-error" class="alert alert-danger validation-error d-none" role="alert" style="display: none;">
            <i class="fas fa-exclamation-triangle"></i>
            <span id="validation-error-message">Inspection title is required</span>
        </div>

        <div class="row">
            <!-- Sidebar with Progress -->
            <div class="col-md-3 bg-light p-3">
                <h4 class="mb-4">
                    <i class="fas fa-clipboard-check"></i>
                    Vehicle Inspection
                </h4>
                
                <!-- Inspector Information -->
                <div class="inspector-info-card" data-testid="inspection-form">
                    <h6><i class="fas fa-user"></i> Inspector Information</h6>
                    <div class="mb-3">
                        <label for="inspector_name" class="form-label">Inspector Name *</label>
                        <input type="text" id="inspector_name" data-testid="inspector-name" class="form-control" placeholder="Enter inspector name" required="" aria-invalid="false" style="">
                    </div>
                    <div class="mb-3">
                        <label for="inspector_id" class="form-label">Inspector ID *</label>
                        <input type="text" id="inspector_id" data-testid="inspector-id" class="form-control" placeholder="Enter inspector ID" required="" aria-invalid="false" style="">
                    </div>
                    <div class="mb-3">
                        <label for="inspection_title" class="form-label">Inspection Title *</label>
                        <input type="text" id="inspection_title" data-testid="inspection-title" class="form-control" placeholder="Enter inspection title" required="" aria-invalid="false" style="">
                    </div>
                </div>

                <!-- VIN Input -->
                <div class="mb-4">
                    <label for="vin" class="form-label">VIN Number</label>
                    <input type="text" id="vin" data-testid="vin-input" class="form-control" placeholder="Enter VIN for auto-fill" style="" aria-invalid="false">
                    <div class="mt-2">
                        <button type="button" id="decode-vin" data-testid="decode-vin" class="btn btn-sm btn-outline-primary">
                            <i class="fas fa-search"></i> Decode VIN
                        </button>
                    </div>
                </div>

                <!-- Vehicle Info Display -->
                <div id="vehicle-info" data-testid="vehicle-info" class="mb-4 vehicle-info-card" style="display: block;">
                    <h6><i class="fas fa-car"></i> Vehicle Information</h6>
                    <div id="vehicle-details" class="small text-muted"><div class="vehicle-info-item"><strong>VIN:</strong> 1HGBH41JXMN109186</div><div class="vehicle-info-item"><strong>Year:</strong> 1991</div><div class="vehicle-info-item"><strong>Make:</strong> HONDA</div><div class="vehicle-info-item"><strong>Model:</strong> ACCORD</div><div class="vehicle-info-item"><strong>Trim:</strong> DX</div><div class="vehicle-info-item"><strong>Body Style:</strong> Sedan</div><div class="vehicle-info-item"><strong>Fuel Type:</strong> Gasoline</div><div class="vehicle-info-item"><strong>Drivetrain:</strong> FWD</div></div>
                </div>

                <!-- Progress -->
                <div class="mb-4">
                    <h6>Progress</h6>
                    <div class="progress mb-2">
                        <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                    </div>
                    <small id="progress-text">0% Complete</small>
                </div>

                <!-- Steps Navigation -->
                <div class="mb-4">
                    <h6>Inspection Sections</h6>
                    <div id="steps-nav"><div class="mb-2">
                    <button class="btn btn-sm w-100 text-start btn-outline-primary" onclick="showStep(0)">
                        <i class="fas fa-clipboard"></i>
                        Inspect exhaust system components for leaks, damage, and proper operation.
                    </button>
                </div><div class="mb-2">
                    <button class="btn btn-sm w-100 text-start btn-outline-primary" onclick="showStep(1)">
                        <i class="fas fa-clipboard"></i>
                        Check steering and suspension components for wear, damage, and safety.
                    </button>
                </div><div class="mb-2">
                    <button class="btn btn-sm w-100 text-start btn-outline-primary" onclick="showStep(2)">
                        <i class="fas fa-clipboard"></i>
                        Inspect ignition system components.
                    </button>
                </div><div class="mb-2">
                    <button class="btn btn-sm w-100 text-start btn-outline-primary" onclick="showStep(3)">
                        <i class="fas fa-clipboard"></i>
                        Check battery and starting system.
                    </button>
                </div><div class="mb-2">
                    <button class="btn btn-sm w-100 text-start btn-outline-primary" onclick="showStep(4)">
                        <i class="fas fa-clipboard"></i>
                        Check for fluid leaks in all major systems.
                    </button>
                </div><div class="mb-2">
                    <button class="btn btn-sm w-100 text-start btn-primary" onclick="showStep(5)">
                        <i class="fas fa-clipboard"></i>
                        Review and recommend maintenance services.
                    </button>
                </div><div class="mb-2">
                    <button class="btn btn-outline-primary btn-sm w-100 text-start" onclick="showStep(6)">
                        <i class="fas fa-clipboard"></i>
                        Inspect brake system for safety and performance.
                    </button>
                </div><div class="mb-2">
                    <button class="btn btn-outline-primary btn-sm w-100 text-start" onclick="showStep(7)">
                        <i class="fas fa-clipboard"></i>
                        Inspect tires and recommend maintenance.
                    </button>
                </div></div>
                </div>

                <!-- Save Button -->
                <div class="mb-4">
                    <button type="button" id="save-inspection" data-testid="save-inspection" class="btn btn-success w-100">
                        <i class="fas fa-save"></i> Save Inspection
                    </button>
                </div>

                <!-- Save Draft Button -->
                <div class="mb-4">
                    <button type="button" id="save-draft" data-testid="save-draft" class="btn btn-outline-primary w-100">
                        <i class="fas fa-edit"></i> Save Draft
                    </button>
                </div>

                <!-- Finalize Button -->
                <div class="mb-4">
                    <button type="button" id="finalize-inspection" data-testid="finalize-inspection" class="btn w-100 btn-secondary" disabled="">
                        <i class="fas fa-lock"></i> Finalize Inspection
                    </button>
                </div>



                <!-- Status Indicator -->
                <div class="mb-4">
                    <div id="inspection-status" data-testid="inspection-status" class="alert alert-info">
                        <i class="fas fa-info-circle"></i> Status: <span id="status-text">Draft</span>
                    </div>
                </div>
                
                <!-- Hidden inspection ID for testing -->
                <input type="hidden" id="inspection-id" data-testid="inspection-id" value="" style="">
            </div>

            <!-- Main Content -->
            <div class="col-md-9 p-4">
                <div id="inspection-content"><div id="step-0" class="step-content" style="display: none;">
                    <div class="step-header p-3 mb-4 rounded">
                        <h3><i class="fas fa-clipboard"></i> Inspect exhaust system components for leaks, damage, and proper operation.</h3>
                    </div>
                    
                            <div class="subcategory-header p-3 mb-3 rounded">
                                <h5><i class="fas fa-folder"></i> Inspect exhaust system components for leaks, damage, and proper operation.</h5>
                            </div>
                            <div class="table-responsive mb-4">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th style="width: 40%">Item</th>
                                            <th style="width: 20%">Status</th>
                                            <th style="width: 20%">Photo</th>
                                            <th style="width: 20%">Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        
                                <tr class="item-row" data-testid="item-row" data-step="Inspect exhaust system components for leaks, damage, and proper operation." data-subcategory="Inspect exhaust system components for leaks, damage, and proper operation." data-item="Exhaust system">
                                    <td>
                                        <label class="form-label">
                                            Exhaust system
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-0-0-0" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-0" id="pass-0-0-0" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-0-0-0">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-0" id="rec-0-0-0" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-0-0-0">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-0" id="req-0-0-0" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-0-0-0">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect exhaust system components for leaks, damage, and proper operation.', 'Inspect exhaust system components for leaks, damage, and proper operation.', 'Exhaust system')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-0-0-0" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect exhaust system components for leaks, damage, and proper operation." data-subcategory="Inspect exhaust system components for leaks, damage, and proper operation." data-item="O2 sensor">
                                    <td>
                                        <label class="form-label">
                                            O2 sensor
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-0-0-1" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-1" id="pass-0-0-1" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-0-0-1">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-1" id="rec-0-0-1" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-0-0-1">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-1" id="req-0-0-1" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-0-0-1">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect exhaust system components for leaks, damage, and proper operation.', 'Inspect exhaust system components for leaks, damage, and proper operation.', 'O2 sensor')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-0-0-1" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect exhaust system components for leaks, damage, and proper operation." data-subcategory="Inspect exhaust system components for leaks, damage, and proper operation." data-item="Exhaust pipe">
                                    <td>
                                        <label class="form-label">
                                            Exhaust pipe
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-0-0-2" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-2" id="pass-0-0-2" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-0-0-2">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-2" id="rec-0-0-2" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-0-0-2">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-2" id="req-0-0-2" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-0-0-2">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect exhaust system components for leaks, damage, and proper operation.', 'Inspect exhaust system components for leaks, damage, and proper operation.', 'Exhaust pipe')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-0-0-2" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect exhaust system components for leaks, damage, and proper operation." data-subcategory="Inspect exhaust system components for leaks, damage, and proper operation." data-item="Muffler">
                                    <td>
                                        <label class="form-label">
                                            Muffler
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-0-0-3" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-3" id="pass-0-0-3" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-0-0-3">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-3" id="rec-0-0-3" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-0-0-3">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-3" id="req-0-0-3" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-0-0-3">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect exhaust system components for leaks, damage, and proper operation.', 'Inspect exhaust system components for leaks, damage, and proper operation.', 'Muffler')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-0-0-3" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect exhaust system components for leaks, damage, and proper operation." data-subcategory="Inspect exhaust system components for leaks, damage, and proper operation." data-item="Tips">
                                    <td>
                                        <label class="form-label">
                                            Tips
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-0-0-4" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-4" id="pass-0-0-4" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-0-0-4">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-4" id="rec-0-0-4" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-0-0-4">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-0-0-4" id="req-0-0-4" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-0-0-4">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect exhaust system components for leaks, damage, and proper operation.', 'Inspect exhaust system components for leaks, damage, and proper operation.', 'Tips')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-0-0-4" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                    </tbody>
                                </table>
                            </div>
                        
                </div><div id="step-1" class="step-content" style="display: none;">
                    <div class="step-header p-3 mb-4 rounded">
                        <h3><i class="fas fa-clipboard"></i> Check steering and suspension components for wear, damage, and safety.</h3>
                    </div>
                    
                            <div class="subcategory-header p-3 mb-3 rounded">
                                <h5><i class="fas fa-folder"></i> Check steering and suspension components for wear, damage, and safety.</h5>
                            </div>
                            <div class="table-responsive mb-4">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th style="width: 40%">Item</th>
                                            <th style="width: 20%">Status</th>
                                            <th style="width: 20%">Photo</th>
                                            <th style="width: 20%">Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Shocks (front/rear)">
                                    <td>
                                        <label class="form-label">
                                            Shocks (front/rear)
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-0" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-0" id="pass-1-0-0" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-0">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-0" id="rec-1-0-0" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-0">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-0" id="req-1-0-0" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-0">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Shocks (front/rear)')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-0" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Struts (front/rear)">
                                    <td>
                                        <label class="form-label">
                                            Struts (front/rear)
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-1" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-1" id="pass-1-0-1" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-1">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-1" id="rec-1-0-1" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-1">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-1" id="req-1-0-1" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-1">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Struts (front/rear)')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-1" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Ball joints (upper/lower)">
                                    <td>
                                        <label class="form-label">
                                            Ball joints (upper/lower)
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-2" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-2" id="pass-1-0-2" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-2">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-2" id="rec-1-0-2" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-2">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-2" id="req-1-0-2" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-2">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Ball joints (upper/lower)')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-2" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Tie rods (inner/outer)">
                                    <td>
                                        <label class="form-label">
                                            Tie rods (inner/outer)
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-3" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-3" id="pass-1-0-3" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-3">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-3" id="rec-1-0-3" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-3">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-3" id="req-1-0-3" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-3">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Tie rods (inner/outer)')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-3" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Control arms (upper/lower)">
                                    <td>
                                        <label class="form-label">
                                            Control arms (upper/lower)
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-4" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-4" id="pass-1-0-4" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-4">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-4" id="rec-1-0-4" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-4">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-4" id="req-1-0-4" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-4">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Control arms (upper/lower)')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-4" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Bushings">
                                    <td>
                                        <label class="form-label">
                                            Bushings
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-5" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-5" id="pass-1-0-5" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-5">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-5" id="rec-1-0-5" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-5">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-5" id="req-1-0-5" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-5">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Bushings')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-5" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Sway bar links">
                                    <td>
                                        <label class="form-label">
                                            Sway bar links
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-6" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-6" id="pass-1-0-6" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-6">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-6" id="rec-1-0-6" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-6">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-6" id="req-1-0-6" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-6">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Sway bar links')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-6" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Center link">
                                    <td>
                                        <label class="form-label">
                                            Center link
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-7" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-7" id="pass-1-0-7" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-7">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-7" id="rec-1-0-7" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-7">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-7" id="req-1-0-7" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-7">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Center link')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-7" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Idler arm">
                                    <td>
                                        <label class="form-label">
                                            Idler arm
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-8" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-8" id="pass-1-0-8" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-8">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-8" id="rec-1-0-8" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-8">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-8" id="req-1-0-8" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-8">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Idler arm')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-8" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Pitman arm">
                                    <td>
                                        <label class="form-label">
                                            Pitman arm
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-9" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-9" id="pass-1-0-9" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-9">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-9" id="rec-1-0-9" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-9">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-9" id="req-1-0-9" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-9">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Pitman arm')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-9" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Rack &amp; pinion">
                                    <td>
                                        <label class="form-label">
                                            Rack &amp; pinion
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-10" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-10" id="pass-1-0-10" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-10">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-10" id="rec-1-0-10" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-10">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-10" id="req-1-0-10" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-10">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Rack &amp; pinion')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-10" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Power steering pump">
                                    <td>
                                        <label class="form-label">
                                            Power steering pump
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-11" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-11" id="pass-1-0-11" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-11">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-11" id="rec-1-0-11" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-11">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-11" id="req-1-0-11" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-11">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Power steering pump')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-11" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check steering and suspension components for wear, damage, and safety." data-subcategory="Check steering and suspension components for wear, damage, and safety." data-item="Steering gear box">
                                    <td>
                                        <label class="form-label">
                                            Steering gear box
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-1-0-12" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-12" id="pass-1-0-12" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-1-0-12">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-12" id="rec-1-0-12" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-1-0-12">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-1-0-12" id="req-1-0-12" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-1-0-12">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check steering and suspension components for wear, damage, and safety.', 'Check steering and suspension components for wear, damage, and safety.', 'Steering gear box')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-1-0-12" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                    </tbody>
                                </table>
                            </div>
                        
                </div><div id="step-2" class="step-content" style="display: none;">
                    <div class="step-header p-3 mb-4 rounded">
                        <h3><i class="fas fa-clipboard"></i> Inspect ignition system components.</h3>
                    </div>
                    
                            <div class="subcategory-header p-3 mb-3 rounded">
                                <h5><i class="fas fa-folder"></i> Inspect ignition system components.</h5>
                            </div>
                            <div class="table-responsive mb-4">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th style="width: 40%">Item</th>
                                            <th style="width: 20%">Status</th>
                                            <th style="width: 20%">Photo</th>
                                            <th style="width: 20%">Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        
                                <tr class="item-row" data-testid="item-row" data-step="Inspect ignition system components." data-subcategory="Inspect ignition system components." data-item="Spark plugs">
                                    <td>
                                        <label class="form-label">
                                            Spark plugs
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-2-0-0" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-0" id="pass-2-0-0" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-2-0-0">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-0" id="rec-2-0-0" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-2-0-0">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-0" id="req-2-0-0" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-2-0-0">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect ignition system components.', 'Inspect ignition system components.', 'Spark plugs')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-2-0-0" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect ignition system components." data-subcategory="Inspect ignition system components." data-item="Plug wires">
                                    <td>
                                        <label class="form-label">
                                            Plug wires
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-2-0-1" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-1" id="pass-2-0-1" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-2-0-1">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-1" id="rec-2-0-1" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-2-0-1">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-1" id="req-2-0-1" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-2-0-1">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect ignition system components.', 'Inspect ignition system components.', 'Plug wires')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-2-0-1" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect ignition system components." data-subcategory="Inspect ignition system components." data-item="Coil pack">
                                    <td>
                                        <label class="form-label">
                                            Coil pack
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-2-0-2" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-2" id="pass-2-0-2" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-2-0-2">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-2" id="rec-2-0-2" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-2-0-2">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-2" id="req-2-0-2" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-2-0-2">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect ignition system components.', 'Inspect ignition system components.', 'Coil pack')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-2-0-2" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect ignition system components." data-subcategory="Inspect ignition system components." data-item="Distributor cap">
                                    <td>
                                        <label class="form-label">
                                            Distributor cap
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-2-0-3" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-3" id="pass-2-0-3" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-2-0-3">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-3" id="rec-2-0-3" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-2-0-3">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-3" id="req-2-0-3" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-2-0-3">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect ignition system components.', 'Inspect ignition system components.', 'Distributor cap')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-2-0-3" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect ignition system components." data-subcategory="Inspect ignition system components." data-item="Rotor">
                                    <td>
                                        <label class="form-label">
                                            Rotor
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-2-0-4" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-4" id="pass-2-0-4" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-2-0-4">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-4" id="rec-2-0-4" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-2-0-4">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-4" id="req-2-0-4" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-2-0-4">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect ignition system components.', 'Inspect ignition system components.', 'Rotor')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-2-0-4" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect ignition system components." data-subcategory="Inspect ignition system components." data-item="Ignition timing">
                                    <td>
                                        <label class="form-label">
                                            Ignition timing
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-2-0-5" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-5" id="pass-2-0-5" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-2-0-5">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-5" id="rec-2-0-5" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-2-0-5">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-2-0-5" id="req-2-0-5" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-2-0-5">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect ignition system components.', 'Inspect ignition system components.', 'Ignition timing')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-2-0-5" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                    </tbody>
                                </table>
                            </div>
                        
                </div><div id="step-3" class="step-content" style="display: none;">
                    <div class="step-header p-3 mb-4 rounded">
                        <h3><i class="fas fa-clipboard"></i> Check battery and starting system.</h3>
                    </div>
                    
                            <div class="subcategory-header p-3 mb-3 rounded">
                                <h5><i class="fas fa-folder"></i> Check battery and starting system.</h5>
                            </div>
                            <div class="table-responsive mb-4">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th style="width: 40%">Item</th>
                                            <th style="width: 20%">Status</th>
                                            <th style="width: 20%">Photo</th>
                                            <th style="width: 20%">Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        
                                <tr class="item-row" data-testid="item-row" data-step="Check battery and starting system." data-subcategory="Check battery and starting system." data-item="Battery condition">
                                    <td>
                                        <label class="form-label">
                                            Battery condition
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-3-0-0" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-0" id="pass-3-0-0" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-3-0-0">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-0" id="rec-3-0-0" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-3-0-0">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-0" id="req-3-0-0" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-3-0-0">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check battery and starting system.', 'Check battery and starting system.', 'Battery condition')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-3-0-0" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check battery and starting system." data-subcategory="Check battery and starting system." data-item="Battery terminals">
                                    <td>
                                        <label class="form-label">
                                            Battery terminals
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-3-0-1" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-1" id="pass-3-0-1" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-3-0-1">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-1" id="rec-3-0-1" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-3-0-1">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-1" id="req-3-0-1" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-3-0-1">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check battery and starting system.', 'Check battery and starting system.', 'Battery terminals')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-3-0-1" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check battery and starting system." data-subcategory="Check battery and starting system." data-item="Battery cables">
                                    <td>
                                        <label class="form-label">
                                            Battery cables
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-3-0-2" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-2" id="pass-3-0-2" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-3-0-2">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-2" id="rec-3-0-2" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-3-0-2">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-2" id="req-3-0-2" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-3-0-2">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check battery and starting system.', 'Check battery and starting system.', 'Battery cables')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-3-0-2" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check battery and starting system." data-subcategory="Check battery and starting system." data-item="Starter operation">
                                    <td>
                                        <label class="form-label">
                                            Starter operation
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-3-0-3" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-3" id="pass-3-0-3" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-3-0-3">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-3" id="rec-3-0-3" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-3-0-3">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-3" id="req-3-0-3" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-3-0-3">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check battery and starting system.', 'Check battery and starting system.', 'Starter operation')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-3-0-3" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check battery and starting system." data-subcategory="Check battery and starting system." data-item="Starter relay">
                                    <td>
                                        <label class="form-label">
                                            Starter relay
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-3-0-4" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-4" id="pass-3-0-4" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-3-0-4">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-4" id="rec-3-0-4" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-3-0-4">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-4" id="req-3-0-4" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-3-0-4">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check battery and starting system.', 'Check battery and starting system.', 'Starter relay')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-3-0-4" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check battery and starting system." data-subcategory="Check battery and starting system." data-item="Alternator output">
                                    <td>
                                        <label class="form-label">
                                            Alternator output
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-3-0-5" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-5" id="pass-3-0-5" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-3-0-5">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-5" id="rec-3-0-5" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-3-0-5">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-5" id="req-3-0-5" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-3-0-5">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check battery and starting system.', 'Check battery and starting system.', 'Alternator output')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-3-0-5" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check battery and starting system." data-subcategory="Check battery and starting system." data-item="Drive belt condition">
                                    <td>
                                        <label class="form-label">
                                            Drive belt condition
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-3-0-6" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-6" id="pass-3-0-6" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-3-0-6">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-6" id="rec-3-0-6" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-3-0-6">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-6" id="req-3-0-6" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-3-0-6">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check battery and starting system.', 'Check battery and starting system.', 'Drive belt condition')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-3-0-6" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check battery and starting system." data-subcategory="Check battery and starting system." data-item="Belt tension">
                                    <td>
                                        <label class="form-label">
                                            Belt tension
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-3-0-7" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-7" id="pass-3-0-7" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-3-0-7">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-7" id="rec-3-0-7" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-3-0-7">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-7" id="req-3-0-7" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-3-0-7">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check battery and starting system.', 'Check battery and starting system.', 'Belt tension')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-3-0-7" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check battery and starting system." data-subcategory="Check battery and starting system." data-item="Ground connections">
                                    <td>
                                        <label class="form-label">
                                            Ground connections
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-3-0-8" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-8" id="pass-3-0-8" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-3-0-8">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-8" id="rec-3-0-8" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-3-0-8">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-3-0-8" id="req-3-0-8" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-3-0-8">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check battery and starting system.', 'Check battery and starting system.', 'Ground connections')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-3-0-8" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                    </tbody>
                                </table>
                            </div>
                        
                </div><div id="step-4" class="step-content" style="display: none;">
                    <div class="step-header p-3 mb-4 rounded">
                        <h3><i class="fas fa-clipboard"></i> Check for fluid leaks in all major systems.</h3>
                    </div>
                    
                            <div class="subcategory-header p-3 mb-3 rounded">
                                <h5><i class="fas fa-folder"></i> Check for fluid leaks in all major systems.</h5>
                            </div>
                            <div class="table-responsive mb-4">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th style="width: 40%">Item</th>
                                            <th style="width: 20%">Status</th>
                                            <th style="width: 20%">Photo</th>
                                            <th style="width: 20%">Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        
                                <tr class="item-row" data-testid="item-row" data-step="Check for fluid leaks in all major systems." data-subcategory="Check for fluid leaks in all major systems." data-item="Engine oil leaks">
                                    <td>
                                        <label class="form-label">
                                            Engine oil leaks
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-4-0-0" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-0" id="pass-4-0-0" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-4-0-0">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-0" id="rec-4-0-0" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-4-0-0">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-0" id="req-4-0-0" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-4-0-0">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check for fluid leaks in all major systems.', 'Check for fluid leaks in all major systems.', 'Engine oil leaks')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-4-0-0" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check for fluid leaks in all major systems." data-subcategory="Check for fluid leaks in all major systems." data-item="Transmission fluid leaks">
                                    <td>
                                        <label class="form-label">
                                            Transmission fluid leaks
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-4-0-1" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-1" id="pass-4-0-1" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-4-0-1">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-1" id="rec-4-0-1" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-4-0-1">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-1" id="req-4-0-1" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-4-0-1">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check for fluid leaks in all major systems.', 'Check for fluid leaks in all major systems.', 'Transmission fluid leaks')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-4-0-1" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check for fluid leaks in all major systems." data-subcategory="Check for fluid leaks in all major systems." data-item="Coolant leaks">
                                    <td>
                                        <label class="form-label">
                                            Coolant leaks
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-4-0-2" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-2" id="pass-4-0-2" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-4-0-2">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-2" id="rec-4-0-2" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-4-0-2">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-2" id="req-4-0-2" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-4-0-2">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check for fluid leaks in all major systems.', 'Check for fluid leaks in all major systems.', 'Coolant leaks')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-4-0-2" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check for fluid leaks in all major systems." data-subcategory="Check for fluid leaks in all major systems." data-item="Brake fluid leaks">
                                    <td>
                                        <label class="form-label">
                                            Brake fluid leaks
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-4-0-3" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-3" id="pass-4-0-3" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-4-0-3">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-3" id="rec-4-0-3" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-4-0-3">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-3" id="req-4-0-3" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-4-0-3">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check for fluid leaks in all major systems.', 'Check for fluid leaks in all major systems.', 'Brake fluid leaks')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-4-0-3" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check for fluid leaks in all major systems." data-subcategory="Check for fluid leaks in all major systems." data-item="Power steering fluid leaks">
                                    <td>
                                        <label class="form-label">
                                            Power steering fluid leaks
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-4-0-4" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-4" id="pass-4-0-4" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-4-0-4">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-4" id="rec-4-0-4" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-4-0-4">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-4" id="req-4-0-4" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-4-0-4">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check for fluid leaks in all major systems.', 'Check for fluid leaks in all major systems.', 'Power steering fluid leaks')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-4-0-4" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check for fluid leaks in all major systems." data-subcategory="Check for fluid leaks in all major systems." data-item="Differential fluid leaks">
                                    <td>
                                        <label class="form-label">
                                            Differential fluid leaks
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-4-0-5" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-5" id="pass-4-0-5" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-4-0-5">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-5" id="rec-4-0-5" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-4-0-5">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-5" id="req-4-0-5" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-4-0-5">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check for fluid leaks in all major systems.', 'Check for fluid leaks in all major systems.', 'Differential fluid leaks')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-4-0-5" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check for fluid leaks in all major systems." data-subcategory="Check for fluid leaks in all major systems." data-item="Transfer case leaks">
                                    <td>
                                        <label class="form-label">
                                            Transfer case leaks
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-4-0-6" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-6" id="pass-4-0-6" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-4-0-6">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-6" id="rec-4-0-6" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-4-0-6">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-6" id="req-4-0-6" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-4-0-6">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check for fluid leaks in all major systems.', 'Check for fluid leaks in all major systems.', 'Transfer case leaks')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-4-0-6" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Check for fluid leaks in all major systems." data-subcategory="Check for fluid leaks in all major systems." data-item="AC refrigerant leaks">
                                    <td>
                                        <label class="form-label">
                                            AC refrigerant leaks
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-4-0-7" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-7" id="pass-4-0-7" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-4-0-7">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-7" id="rec-4-0-7" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-4-0-7">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-4-0-7" id="req-4-0-7" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-4-0-7">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Check for fluid leaks in all major systems.', 'Check for fluid leaks in all major systems.', 'AC refrigerant leaks')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-4-0-7" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                    </tbody>
                                </table>
                            </div>
                        
                </div><div id="step-5" class="step-content" style="display: block;">
                    <div class="step-header p-3 mb-4 rounded">
                        <h3><i class="fas fa-clipboard"></i> Review and recommend maintenance services.</h3>
                    </div>
                    
                            <div class="subcategory-header p-3 mb-3 rounded">
                                <h5><i class="fas fa-folder"></i> Review and recommend maintenance services.</h5>
                            </div>
                            <div class="table-responsive mb-4">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th style="width: 40%">Item</th>
                                            <th style="width: 20%">Status</th>
                                            <th style="width: 20%">Photo</th>
                                            <th style="width: 20%">Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Oil change due">
                                    <td>
                                        <label class="form-label">
                                            Oil change due
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-0" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-0" id="pass-5-0-0" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-0">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-0" id="rec-5-0-0" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-0">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-0" id="req-5-0-0" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-0">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Oil change due')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-0" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Air filter replacement">
                                    <td>
                                        <label class="form-label">
                                            Air filter replacement
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-1" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-1" id="pass-5-0-1" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-1">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-1" id="rec-5-0-1" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-1">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-1" id="req-5-0-1" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-1">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Air filter replacement')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-1" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Cabin filter replacement">
                                    <td>
                                        <label class="form-label">
                                            Cabin filter replacement
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-2" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-2" id="pass-5-0-2" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-2">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-2" id="rec-5-0-2" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-2">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-2" id="req-5-0-2" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-2">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Cabin filter replacement')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-2" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Fuel filter replacement">
                                    <td>
                                        <label class="form-label">
                                            Fuel filter replacement
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-3" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-3" id="pass-5-0-3" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-3">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-3" id="rec-5-0-3" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-3">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-3" id="req-5-0-3" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-3">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Fuel filter replacement')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-3" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Spark plug replacement">
                                    <td>
                                        <label class="form-label">
                                            Spark plug replacement
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-4" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-4" id="pass-5-0-4" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-4">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-4" id="rec-5-0-4" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-4">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-4" id="req-5-0-4" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-4">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Spark plug replacement')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-4" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Timing belt/chain replacement">
                                    <td>
                                        <label class="form-label">
                                            Timing belt/chain replacement
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-5" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-5" id="pass-5-0-5" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-5">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-5" id="rec-5-0-5" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-5">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-5" id="req-5-0-5" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-5">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Timing belt/chain replacement')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-5" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Coolant flush">
                                    <td>
                                        <label class="form-label">
                                            Coolant flush
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-6" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-6" id="pass-5-0-6" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-6">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-6" id="rec-5-0-6" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-6">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-6" id="req-5-0-6" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-6">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Coolant flush')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-6" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Transmission service">
                                    <td>
                                        <label class="form-label">
                                            Transmission service
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-7" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-7" id="pass-5-0-7" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-7">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-7" id="rec-5-0-7" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-7">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-7" id="req-5-0-7" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-7">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Transmission service')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-7" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Brake fluid flush">
                                    <td>
                                        <label class="form-label">
                                            Brake fluid flush
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-8" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-8" id="pass-5-0-8" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-8">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-8" id="rec-5-0-8" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-8">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-8" id="req-5-0-8" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-8">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Brake fluid flush')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-8" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Power steering service">
                                    <td>
                                        <label class="form-label">
                                            Power steering service
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-9" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-9" id="pass-5-0-9" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-9">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-9" id="rec-5-0-9" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-9">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-9" id="req-5-0-9" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-9">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Power steering service')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-9" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Differential service">
                                    <td>
                                        <label class="form-label">
                                            Differential service
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-10" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-10" id="pass-5-0-10" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-10">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-10" id="rec-5-0-10" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-10">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-10" id="req-5-0-10" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-10">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Differential service')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-10" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Review and recommend maintenance services." data-subcategory="Review and recommend maintenance services." data-item="Transfer case service">
                                    <td>
                                        <label class="form-label">
                                            Transfer case service
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-5-0-11" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-11" id="pass-5-0-11" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-5-0-11">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-11" id="rec-5-0-11" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-5-0-11">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-5-0-11" id="req-5-0-11" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-5-0-11">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Review and recommend maintenance services.', 'Review and recommend maintenance services.', 'Transfer case service')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-5-0-11" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                    </tbody>
                                </table>
                            </div>
                        
                </div><div id="step-6" class="step-content" style="display: none;">
                    <div class="step-header p-3 mb-4 rounded">
                        <h3><i class="fas fa-clipboard"></i> Inspect brake system for safety and performance.</h3>
                    </div>
                    
                            <div class="subcategory-header p-3 mb-3 rounded">
                                <h5><i class="fas fa-folder"></i> Inspect brake system for safety and performance.</h5>
                            </div>
                            <div class="table-responsive mb-4">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th style="width: 40%">Item</th>
                                            <th style="width: 20%">Status</th>
                                            <th style="width: 20%">Photo</th>
                                            <th style="width: 20%">Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        
                                <tr class="item-row" data-testid="item-row" data-step="Inspect brake system for safety and performance." data-subcategory="Inspect brake system for safety and performance." data-item="Pad thickness (LF, RF, LR, RR)">
                                    <td>
                                        <label class="form-label">
                                            Pad thickness (LF, RF, LR, RR)
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-6-0-0" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-0" id="pass-6-0-0" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-6-0-0">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-0" id="rec-6-0-0" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-6-0-0">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-0" id="req-6-0-0" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-6-0-0">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect brake system for safety and performance.', 'Inspect brake system for safety and performance.', 'Pad thickness (LF, RF, LR, RR)')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-6-0-0" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect brake system for safety and performance." data-subcategory="Inspect brake system for safety and performance." data-item="Rotor thickness (LF, RF, LR, RR)">
                                    <td>
                                        <label class="form-label">
                                            Rotor thickness (LF, RF, LR, RR)
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-6-0-1" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-1" id="pass-6-0-1" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-6-0-1">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-1" id="rec-6-0-1" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-6-0-1">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-1" id="req-6-0-1" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-6-0-1">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect brake system for safety and performance.', 'Inspect brake system for safety and performance.', 'Rotor thickness (LF, RF, LR, RR)')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-6-0-1" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect brake system for safety and performance." data-subcategory="Inspect brake system for safety and performance." data-item="Rotor condition (scoring, warping)">
                                    <td>
                                        <label class="form-label">
                                            Rotor condition (scoring, warping)
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-6-0-2" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-2" id="pass-6-0-2" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-6-0-2">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-2" id="rec-6-0-2" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-6-0-2">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-2" id="req-6-0-2" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-6-0-2">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect brake system for safety and performance.', 'Inspect brake system for safety and performance.', 'Rotor condition (scoring, warping)')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-6-0-2" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect brake system for safety and performance." data-subcategory="Inspect brake system for safety and performance." data-item="Brake lines and hoses">
                                    <td>
                                        <label class="form-label">
                                            Brake lines and hoses
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-6-0-3" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-3" id="pass-6-0-3" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-6-0-3">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-3" id="rec-6-0-3" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-6-0-3">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-3" id="req-6-0-3" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-6-0-3">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect brake system for safety and performance.', 'Inspect brake system for safety and performance.', 'Brake lines and hoses')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-6-0-3" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect brake system for safety and performance." data-subcategory="Inspect brake system for safety and performance." data-item="Caliper operation">
                                    <td>
                                        <label class="form-label">
                                            Caliper operation
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-6-0-4" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-4" id="pass-6-0-4" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-6-0-4">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-4" id="rec-6-0-4" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-6-0-4">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-4" id="req-6-0-4" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-6-0-4">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect brake system for safety and performance.', 'Inspect brake system for safety and performance.', 'Caliper operation')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-6-0-4" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect brake system for safety and performance." data-subcategory="Inspect brake system for safety and performance." data-item="Master cylinder">
                                    <td>
                                        <label class="form-label">
                                            Master cylinder
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-6-0-5" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-5" id="pass-6-0-5" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-6-0-5">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-5" id="rec-6-0-5" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-6-0-5">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-5" id="req-6-0-5" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-6-0-5">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect brake system for safety and performance.', 'Inspect brake system for safety and performance.', 'Master cylinder')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-6-0-5" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect brake system for safety and performance." data-subcategory="Inspect brake system for safety and performance." data-item="Brake booster">
                                    <td>
                                        <label class="form-label">
                                            Brake booster
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-6-0-6" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-6" id="pass-6-0-6" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-6-0-6">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-6" id="rec-6-0-6" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-6-0-6">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-6" id="req-6-0-6" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-6-0-6">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect brake system for safety and performance.', 'Inspect brake system for safety and performance.', 'Brake booster')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-6-0-6" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect brake system for safety and performance." data-subcategory="Inspect brake system for safety and performance." data-item="Parking brake operation">
                                    <td>
                                        <label class="form-label">
                                            Parking brake operation
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-6-0-7" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-7" id="pass-6-0-7" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-6-0-7">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-7" id="rec-6-0-7" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-6-0-7">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-7" id="req-6-0-7" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-6-0-7">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect brake system for safety and performance.', 'Inspect brake system for safety and performance.', 'Parking brake operation')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-6-0-7" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect brake system for safety and performance." data-subcategory="Inspect brake system for safety and performance." data-item="ABS operation">
                                    <td>
                                        <label class="form-label">
                                            ABS operation
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-6-0-8" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-8" id="pass-6-0-8" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-6-0-8">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-8" id="rec-6-0-8" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-6-0-8">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-6-0-8" id="req-6-0-8" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-6-0-8">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect brake system for safety and performance.', 'Inspect brake system for safety and performance.', 'ABS operation')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-6-0-8" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                    </tbody>
                                </table>
                            </div>
                        
                </div><div id="step-7" class="step-content" style="display: none;">
                    <div class="step-header p-3 mb-4 rounded">
                        <h3><i class="fas fa-clipboard"></i> Inspect tires and recommend maintenance.</h3>
                    </div>
                    
                            <div class="subcategory-header p-3 mb-3 rounded">
                                <h5><i class="fas fa-folder"></i> Inspect tires and recommend maintenance.</h5>
                            </div>
                            <div class="table-responsive mb-4">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th style="width: 40%">Item</th>
                                            <th style="width: 20%">Status</th>
                                            <th style="width: 20%">Photo</th>
                                            <th style="width: 20%">Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        
                                <tr class="item-row" data-testid="item-row" data-step="Inspect tires and recommend maintenance." data-subcategory="Inspect tires and recommend maintenance." data-item="Tire tread depth (LF, RF, LR, RR)">
                                    <td>
                                        <label class="form-label">
                                            Tire tread depth (LF, RF, LR, RR)
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-7-0-0" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-0" id="pass-7-0-0" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-7-0-0">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-0" id="rec-7-0-0" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-7-0-0">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-0" id="req-7-0-0" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-7-0-0">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect tires and recommend maintenance.', 'Inspect tires and recommend maintenance.', 'Tire tread depth (LF, RF, LR, RR)')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-7-0-0" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect tires and recommend maintenance." data-subcategory="Inspect tires and recommend maintenance." data-item="Tire pressure (LF, RF, LR, RR)">
                                    <td>
                                        <label class="form-label">
                                            Tire pressure (LF, RF, LR, RR)
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-7-0-1" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-1" id="pass-7-0-1" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-7-0-1">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-1" id="rec-7-0-1" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-7-0-1">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-1" id="req-7-0-1" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-7-0-1">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect tires and recommend maintenance.', 'Inspect tires and recommend maintenance.', 'Tire pressure (LF, RF, LR, RR)')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-7-0-1" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect tires and recommend maintenance." data-subcategory="Inspect tires and recommend maintenance." data-item="Tire sidewall condition">
                                    <td>
                                        <label class="form-label">
                                            Tire sidewall condition
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-7-0-2" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-2" id="pass-7-0-2" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-7-0-2">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-2" id="rec-7-0-2" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-7-0-2">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-2" id="req-7-0-2" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-7-0-2">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect tires and recommend maintenance.', 'Inspect tires and recommend maintenance.', 'Tire sidewall condition')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-7-0-2" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect tires and recommend maintenance." data-subcategory="Inspect tires and recommend maintenance." data-item="Tire wear patterns">
                                    <td>
                                        <label class="form-label">
                                            Tire wear patterns
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-7-0-3" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-3" id="pass-7-0-3" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-7-0-3">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-3" id="rec-7-0-3" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-7-0-3">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-3" id="req-7-0-3" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-7-0-3">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect tires and recommend maintenance.', 'Inspect tires and recommend maintenance.', 'Tire wear patterns')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-7-0-3" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect tires and recommend maintenance." data-subcategory="Inspect tires and recommend maintenance." data-item="Tire age/date code">
                                    <td>
                                        <label class="form-label">
                                            Tire age/date code
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-7-0-4" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-4" id="pass-7-0-4" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-7-0-4">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-4" id="rec-7-0-4" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-7-0-4">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-4" id="req-7-0-4" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-7-0-4">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect tires and recommend maintenance.', 'Inspect tires and recommend maintenance.', 'Tire age/date code')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-7-0-4" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect tires and recommend maintenance." data-subcategory="Inspect tires and recommend maintenance." data-item="Spare tire condition">
                                    <td>
                                        <label class="form-label">
                                            Spare tire condition
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-7-0-5" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-5" id="pass-7-0-5" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-7-0-5">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-5" id="rec-7-0-5" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-7-0-5">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-5" id="req-7-0-5" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-7-0-5">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect tires and recommend maintenance.', 'Inspect tires and recommend maintenance.', 'Spare tire condition')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-7-0-5" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect tires and recommend maintenance." data-subcategory="Inspect tires and recommend maintenance." data-item="Wheel alignment">
                                    <td>
                                        <label class="form-label">
                                            Wheel alignment
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-7-0-6" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-6" id="pass-7-0-6" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-7-0-6">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-6" id="rec-7-0-6" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-7-0-6">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-6" id="req-7-0-6" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-7-0-6">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect tires and recommend maintenance.', 'Inspect tires and recommend maintenance.', 'Wheel alignment')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-7-0-6" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect tires and recommend maintenance." data-subcategory="Inspect tires and recommend maintenance." data-item="Tire rotation">
                                    <td>
                                        <label class="form-label">
                                            Tire rotation
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-7-0-7" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-7" id="pass-7-0-7" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-7-0-7">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-7" id="rec-7-0-7" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-7-0-7">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-7" id="req-7-0-7" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-7-0-7">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect tires and recommend maintenance.', 'Inspect tires and recommend maintenance.', 'Tire rotation')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-7-0-7" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                <tr class="item-row" data-testid="item-row" data-step="Inspect tires and recommend maintenance." data-subcategory="Inspect tires and recommend maintenance." data-item="Tire balance">
                                    <td>
                                        <label class="form-label">
                                            Tire balance
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-7-0-8" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-8" id="pass-7-0-8" value="pass" data-testid="status-pass" style="">
                                                <label class="form-check-label" for="pass-7-0-8">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-8" id="rec-7-0-8" value="rec" data-testid="status-recommended" style="">
                                                <label class="form-check-label" for="rec-7-0-8">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-7-0-8" id="req-7-0-8" value="req" data-testid="status-required" style="">
                                                <label class="form-check-label" for="req-7-0-8">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload" onclick="openPhotoModal('Inspect tires and recommend maintenance.', 'Inspect tires and recommend maintenance.', 'Tire balance')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-7-0-8" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note" rows="2" placeholder="Notes..." style=""></textarea>
                                    </td>
                                </tr>
                            
                                    </tbody>
                                </table>
                            </div>
                        
                </div></div>
            </div>
        </div>
    </div>

    <!-- Photo Upload Modal -->
    <div class="modal fade" id="photoModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Upload Photo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="photo-form">
                        <div class="mb-3">
                            <label for="photo-file" class="form-label">Select Photo</label>
                            <input type="file" id="photo-file" class="form-control" accept="image/*" required="" style="">
                        </div>
                        <div class="mb-3">
                            <label for="camera-input" class="form-label">Or Take Photo</label>
                            <input type="file" id="camera-input" class="form-control" accept="image/*" capture="environment" style="">
                        </div>
                        <div id="upload-area" class="border-2 border-dashed p-4 text-center" style="border-style: dashed;">
                            <i class="fas fa-cloud-upload-alt fa-2x text-muted"></i>
                            <p class="mt-2">Drag and drop photo here or click to select</p>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="uploadPhoto()">Upload Photo</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/error-handler.js"></script><div id="error-toast-container" class="position-fixed" style="top: 20px; right: 20px; z-index: 9999; max-width: 400px;"></div>
    <script src="/static/js/api-client.js"></script>
    <script>
        let inspectionTemplate = {"description": "Comprehensive automotive inspection based on industry standard checklist.", "inspection_name": "Vehicle Inspection / Maintenance Services", "inspection_points": {"brakes": {"description": "Brakes", "items": ["ABS (Yes/No)", "LF Pad", "LF Rotor", "RF Pad", "RF Rotor", "LR Pad", "LR Rotor", "RR Pad", "RR Rotor", "Rear Clean/Adj", "Brake Hose(s)", "Parking Cables", "Other Brake Services", "Hardware", "Caliper", "Wheel Cylinder", "Repack"]}, "engine_bay": {"description": "Engine Bay", "items": ["Battery", "Battery Accessories", "Start / Charge Test", "Cable(s) POS+", "Cable(s) NEG-", "Hold Downs", "Belts - ALT", "Belts - PS", "Belts - A/C", "Belts - AP", "Belts - Serp", "Timing Belt", "Belt Tensioner", "Spark Plugs", "Cable / Boot", "Coils"]}, "exhaust": {"description": "Exhaust", "items": ["Exhaust System - Inter. Pipe", "Exhaust System - Muffler", "Exhaust System - Tailpipe", "Catalytic Converter", "O2 Sensor"]}, "fluid_leaks": {"description": "Fluid Leaks", "items": ["Engine Oil", "Power Steering", "Coolant", "Trans. / Case", "Brake", "Differential Front", "Differential Rear", "Coolant Level Flush", "Coolant Hoses"]}, "steering_suspension": {"description": "Steering \u0026 Suspension", "subcategories": {"ball_joints": {"items": ["Ball Joints - L Upper", "Ball Joints - L Lower", "Ball Joints - R Upper", "Ball Joints - R Lower"], "name": "Ball Joints"}, "bushings": {"items": ["Bushings - Control Arm", "Bushings - Sway Bar", "Bushings - Sleeve(s)"], "name": "Bushings"}, "cv_axles": {"items": ["CV Boots - L Out", "CV Boots - L In", "CV Boots - R Out", "CV Boots - R In", "CV Joints - L Out", "CV Joints - L In", "CV Joints - R Out", "CV Joints - R In"], "name": "CV Axles \u0026 Joints"}, "shocks_struts": {"items": ["Struts - Front", "Struts - Rear", "Struts - Left", "Struts - Right", "Shocks - Front", "Shocks - Rear", "Shocks - Left", "Shocks - Right"], "name": "Shocks \u0026 Struts"}, "steering_components": {"items": ["Idler Arm", "Pitman Arm", "Center Link", "Rack \u0026 Pinion - L Out", "Rack \u0026 Pinion - L In", "Rack \u0026 Pinion - R Out", "Rack \u0026 Pinion - R In"], "name": "Steering Components"}, "tie_rods": {"items": ["Tie Rod Ends - L Out", "Tie Rod Ends - L In", "Tie Rod Ends - R Out", "Tie Rod Ends - R In"], "name": "Tie Rods"}}}, "tires_tire_maintenance": {"description": "Tires \u0026 Tire Maintenance", "items": ["Tire Size (F/R)", "Speed/Load Rating", "Run Flat (Y/N)", "TPMS (Y/N)", "Left Front - PSI In", "Left Front - PSI Out", "Left Front - Tread Depth Outer", "Left Front - Tread Depth Inner", "Left Front - Edgewear", "Left Front - Cracking", "Left Front - Cupping", "Left Front - Puncture", "Left Front - Cuts", "Left Front - Irregularity", "Left Front - Repairable", "Left Front - Unrepairable", "Right Front - PSI In", "Right Front - PSI Out", "Right Front - Tread Depth Outer", "Right Front - Tread Depth Inner", "Right Front - Edgewear", "Right Front - Cracking", "Right Front - Cupping", "Right Front - Puncture", "Right Front - Cuts", "Right Front - Irregularity", "Right Front - Repairable", "Right Front - Unrepairable", "Left Rear - PSI In", "Left Rear - PSI Out", "Left Rear - Tread Depth Outer", "Left Rear - Tread Depth Inner", "Left Rear - Edgewear", "Left Rear - Cracking", "Left Rear - Cupping", "Left Rear - Puncture", "Left Rear - Cuts", "Left Rear - Irregularity", "Left Rear - Repairable", "Left Rear - Unrepairable", "Right Rear - PSI In", "Right Rear - PSI Out", "Right Rear - Tread Depth Outer", "Right Rear - Tread Depth Inner", "Right Rear - Edgewear", "Right Rear - Cracking", "Right Rear - Cupping", "Right Rear - Puncture", "Right Rear - Cuts", "Right Rear - Irregularity", "Right Rear - Repairable", "Right Rear - Unrepairable", "Spare - PSI In", "Spare - PSI Out", "Spare - Tread Depth Outer", "Spare - Tread Depth Inner", "Spare - Edgewear", "Spare - Cracking", "Spare - Cupping", "Spare - Puncture", "Spare - Cuts", "Spare - Irregularity", "Spare - Repairable", "Spare - Unrepairable", "Tire Rotation", "Tire Balance", "Tire Wear", "Alignment Check"]}, "vehicle_inspection_maintenance": {"description": "Vehicle Inspection / Maintenance Services", "items": ["Wiper Blades", "Head Lights", "Mini Lights", "Air Filter", "Cabin Air Filter", "Fuel Filter", "Fuel System Service", "Power Steering Fluid", "Master Cyl. Fluid"]}}};
        let currentStep = 0;
        let inspectionData = {
            id: null,
            title: '',
            industry_info: {
                name: 'Automotive',
                type: 'automotive'
            },
            inspector_name: '',
            inspector_id: '',
            vin: '',
            vehicle_id: null,
            date: new Date().toISOString(),
            industry_type: 'automotive',
            categories: [],
            status: 'draft'
        };
        let inspectionId = null;
        let currentPhotoItem = null;

        // Initialize the inspection form
        document.addEventListener('DOMContentLoaded', function() {
            // Force fresh template load with cache busting
            const timestamp = new Date().getTime();
            window.apiClient.getInspectionTemplateLegacy()
                .then(template => {
                    if (template) {
                        inspectionTemplate = template;
                        loadInspectionTemplate();
                        setupEventListeners();
                        
                        // Check if we're editing an existing inspection
                        const urlParams = new URLSearchParams(window.location.search);
                        const editInspectionId = urlParams.get('id');
                        
                        if (editInspectionId) {
                            loadExistingInspection(editInspectionId);
                        } else {
                            createInspection();
                        }
                        
                        updateFinalizeButtonState();
                        setupTireInspectionHandlers();
                    } else {
                        console.error('Error loading template - no data returned');
                        // Fallback to server-side template
                        loadInspectionTemplate();
                        setupEventListeners();
                        createInspection();
                        updateFinalizeButtonState();
                        setupTireInspectionHandlers();
                    }
                })
                .catch(error => {
                    console.error('Error loading template:', error);
                    // Fallback to server-side template
                    loadInspectionTemplate();
                    setupEventListeners();
                    createInspection();
                    updateFinalizeButtonState();
                    setupTireInspectionHandlers();
                });
        });

        function loadInspectionTemplate() {
            const content = document.getElementById('inspection-content');
            const stepsNav = document.getElementById('steps-nav');
            
            content.innerHTML = '';
            stepsNav.innerHTML = '';
            
            // Convert inspection_points to steps format
            const steps = Object.entries(inspectionTemplate.inspection_points).map(([key, value]) => {
                // Check if this step has subsections (like Steering & Suspension)
                if (value.subcategories) {
                    return {
                        name: value.description,
                        subcategories: value.subcategories
                    };
                } else {
                    // Legacy format - convert to single subcategory
                    return {
                        name: value.description,
                        subcategories: [{
                            name: value.description,
                            items: value.items
                        }]
                    };
                }
            });
            
            steps.forEach((step, stepIndex) => {
                // Create step navigation
                const stepNav = document.createElement('div');
                stepNav.className = 'mb-2';
                stepNav.innerHTML = `
                    <button class="btn btn-outline-primary btn-sm w-100 text-start" 
                            onclick="showStep(${stepIndex})">
                        <i class="fas fa-${getStepIcon(step.name)}"></i>
                        ${step.name}
                    </button>
                `;
                stepsNav.appendChild(stepNav);
                
                // Create step content
                const stepContent = document.createElement('div');
                stepContent.id = `step-${stepIndex}`;
                stepContent.className = 'step-content';
                stepContent.style.display = stepIndex === 0 ? 'block' : 'none';
                
                stepContent.innerHTML = `
                    <div class="step-header p-3 mb-4 rounded">
                        <h3><i class="fas fa-${getStepIcon(step.name)}"></i> ${step.name}</h3>
                    </div>
                    ${generateStepContent(step, stepIndex)}
                `;
                
                content.appendChild(stepContent);
            });
            
            showStep(0);
        }

        function getStepIcon(stepName) {
            const icons = {
                'Engine Bay': 'engine',
                'Vehicle Inspection / Maintenance Services': 'tools',
                'Brakes': 'brake',
                'Tires & Tire Maintenance': 'tire',
                'Steering & Suspension': 'cogs',
                'Fluid Leaks': 'droplet',
                'Exhaust': 'smoke'
            };
            return icons[stepName] || 'clipboard';
        }

        function generateStepContent(step, stepIndex) {
            let html = '';
            
            // Special layout for Tires & Tire Maintenance section
            if (step.name === 'Tires & Tire Maintenance') {
                html += generateTiresLayout(step, stepIndex);
            } else {
                // Check if this step has subsections (like Steering & Suspension)
                if (step.subcategories && typeof step.subcategories === 'object' && !Array.isArray(step.subcategories)) {
                    // Handle subsections structure
                    Object.entries(step.subcategories).forEach(([subKey, subcategory]) => {
                        html += `
                            <div class="subcategory-header p-3 mb-3 rounded">
                                <h5><i class="fas fa-folder"></i> ${subcategory.name}</h5>
                            </div>
                            <div class="table-responsive mb-4">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th style="width: 40%">Item</th>
                                            <th style="width: 20%">Status</th>
                                            <th style="width: 20%">Photo</th>
                                            <th style="width: 20%">Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        `;
                        
                        subcategory.items.forEach((item, itemIndex) => {
                            const itemId = `${stepIndex}-${subKey}-${itemIndex}`;
                            html += `
                                <tr class="item-row" data-testid="item-row" data-step="${step.name}" data-subcategory="${subcategory.name}" data-item="${item}">
                                    <td>
                                        <label class="form-label">
                                            ${item}
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-${itemId}" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-${itemId}" 
                                                       id="pass-${itemId}" value="pass" data-testid="status-pass">
                                                <label class="form-check-label" for="pass-${itemId}">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-${itemId}" 
                                                       id="rec-${itemId}" value="rec" data-testid="status-recommended">
                                                <label class="form-check-label" for="rec-${itemId}">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-${itemId}" 
                                                       id="req-${itemId}" value="req" data-testid="status-required">
                                                <label class="form-check-label" for="req-${itemId}">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload"
                                                onclick="openPhotoModal('${step.name}', '${subcategory.name}', '${item}')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-${itemId}" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note"
                                                  rows="2" placeholder="Notes..."></textarea>
                                    </td>
                                </tr>
                            `;
                        });
                        
                        html += `
                                    </tbody>
                                </table>
                            </div>
                        `;
                    });
                } else {
                    // Standard layout for other sections (legacy format)
                    step.subcategories.forEach((subcategory, subIndex) => {
                        html += `
                            <div class="subcategory-header p-3 mb-3 rounded">
                                <h5><i class="fas fa-folder"></i> ${subcategory.name}</h5>
                            </div>
                            <div class="table-responsive mb-4">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th style="width: 40%">Item</th>
                                            <th style="width: 20%">Status</th>
                                            <th style="width: 20%">Photo</th>
                                            <th style="width: 20%">Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        `;
                        
                        subcategory.items.forEach((item, itemIndex) => {
                            const itemId = `${stepIndex}-${subIndex}-${itemIndex}`;
                            html += `
                                <tr class="item-row" data-testid="item-row" data-step="${step.name}" data-subcategory="${subcategory.name}" data-item="${item}">
                                    <td>
                                        <label class="form-label">
                                            ${item}
                                        </label>
                                    </td>
                                    <td>
                                        <div class="status-checkboxes" id="status-${itemId}" data-testid="status-checkboxes">
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-${itemId}" 
                                                       id="pass-${itemId}" value="pass" data-testid="status-pass">
                                                <label class="form-check-label" for="pass-${itemId}">✅ Pass</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-${itemId}" 
                                                       id="rec-${itemId}" value="rec" data-testid="status-recommended">
                                                <label class="form-check-label" for="rec-${itemId}">⚠️ Recommended</label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <input class="form-check-input status-checkbox" type="radio" name="status-${itemId}" 
                                                       id="req-${itemId}" value="req" data-testid="status-required">
                                                <label class="form-check-label" for="req-${itemId}">❌ Required</label>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-outline-secondary photo-btn" data-testid="photo-upload"
                                                onclick="openPhotoModal('${step.name}', '${subcategory.name}', '${item}')">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                        <div id="photo-${itemId}" class="mt-1" data-testid="photo-thumbnail"></div>
                                    </td>
                                    <td>
                                        <textarea class="form-control form-control-sm notes-input" data-testid="notes-input item-note"
                                                  rows="2" placeholder="Notes..."></textarea>
                                    </td>
                                </tr>
                            `;
                        });
                        
                        html += `
                                    </tbody>
                                </table>
                            </div>
                        `;
                    });
                }
            }
            
            return html;
        }

        function generateTiresLayout(step, stepIndex) {
            // Get the current inspection ID
            const inspectionId = document.getElementById('inspection-id').value || 'new_inspection_' + Date.now();
            
            // Return our new tire inspection section
            return `
                <div id="tire-inspection-section" class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">TIRES & TIRE MAINTENANCE</h3>
                    
                    <!-- Header Row -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <!-- Tire Brand/Pattern -->
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-gray-700">Tire F / R</label>
                            <div class="flex space-x-2">
                                <input type="text" id="tire-front" name="tire_front" placeholder="Front tire" 
                                       class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <input type="text" id="tire-rear" name="tire_rear" placeholder="Rear tire" 
                                       class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <!-- Speed/Load -->
                        <div class="space-y-2">
                            <label class="block text-sm font-medium text-gray-700">Speed/Load F / R</label>
                            <div class="space-y-2">
                                <input type="text" id="speed-load-front" name="speed_load_front" placeholder="94V" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <input type="text" id="speed-load-rear" name="speed_load_rear" placeholder="94V" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tire Inspections -->
                    <div class="space-y-6">
                        <!-- Left Front Tire -->
                        <div class="border border-gray-300 rounded-lg p-4">
                            <h4 class="font-medium text-gray-800 mb-3">Left Front Tire</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Measurements -->
                                <div class="space-y-3">
                                    <div class="grid grid-cols-3 gap-2">
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">PSI In</label>
                                            <input type="number" id="psi-in-LF" name="psi_in_LF" min="0" max="80" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">PSI Out</label>
                                            <input type="number" id="psi-out-LF" name="psi_out_LF" min="0" max="80" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">Tread (32nds)</label>
                                            <input type="number" id="tread-LF" name="tread_LF" min="0" max="20" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                    </div>
                                    <!-- Status Checkboxes -->
                                    <div class="flex space-x-4">
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_LF" value="pass" class="rounded border-gray-300 text-green-600 focus:ring-green-500">
                                            <span class="text-sm text-gray-700">Pass</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_LF" value="recommended" class="rounded border-gray-300 text-yellow-600 focus:ring-yellow-500">
                                            <span class="text-sm text-gray-700">Recommended</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_LF" value="fail" class="rounded border-gray-300 text-red-600 focus:ring-red-500">
                                            <span class="text-sm text-gray-700">Fail</span>
                                        </label>
                                    </div>
                                </div>
                                <!-- Conditions -->
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700">Conditions / Observations</label>
                                    <div class="grid grid-cols-2 gap-2 text-xs">
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LF_even_wear" name="cond_LF_even_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Even wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LF_inner_wear" name="cond_LF_inner_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Inner wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LF_outer_wear" name="cond_LF_outer_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Outer wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LF_center_wear" name="cond_LF_center_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Center wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LF_cupping" name="cond_LF_cupping" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Cupping</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LF_sidewall_damage" name="cond_LF_sidewall_damage" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Sidewall damage</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LF_cracking" name="cond_LF_cracking" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Cracking</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LF_puncture" name="cond_LF_puncture" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Puncture</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right Front Tire -->
                        <div class="border border-gray-300 rounded-lg p-4">
                            <h4 class="font-medium text-gray-800 mb-3">Right Front Tire</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Measurements -->
                                <div class="space-y-3">
                                    <div class="grid grid-cols-3 gap-2">
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">PSI In</label>
                                            <input type="number" id="psi-in-RF" name="psi_in_RF" min="0" max="80" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">PSI Out</label>
                                            <input type="number" id="psi-out-RF" name="psi_out_RF" min="0" max="80" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">Tread (32nds)</label>
                                            <input type="number" id="tread-RF" name="tread_RF" min="0" max="20" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                    </div>
                                    <!-- Status Checkboxes -->
                                    <div class="flex space-x-4">
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_RF" value="pass" class="rounded border-gray-300 text-green-600 focus:ring-green-500">
                                            <span class="text-sm text-gray-700">Pass</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_RF" value="recommended" class="rounded border-gray-300 text-yellow-600 focus:ring-yellow-500">
                                            <span class="text-sm text-gray-700">Recommended</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_RF" value="fail" class="rounded border-gray-300 text-red-600 focus:ring-red-500">
                                            <span class="text-sm text-gray-700">Fail</span>
                                        </label>
                                    </div>
                                </div>
                                <!-- Conditions -->
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700">Conditions / Observations</label>
                                    <div class="grid grid-cols-2 gap-2 text-xs">
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RF_even_wear" name="cond_RF_even_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Even wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RF_inner_wear" name="cond_RF_inner_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Inner wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RF_outer_wear" name="cond_RF_outer_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Outer wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RF_center_wear" name="cond_RF_center_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Center wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RF_cupping" name="cond_RF_cupping" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Cupping</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RF_sidewall_damage" name="cond_RF_sidewall_damage" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Sidewall damage</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RF_cracking" name="cond_RF_cracking" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Cracking</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RF_puncture" name="cond_RF_puncture" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Puncture</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Left Rear Tire -->
                        <div class="border border-gray-300 rounded-lg p-4">
                            <h4 class="font-medium text-gray-800 mb-3">Left Rear Tire</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Measurements -->
                                <div class="space-y-3">
                                    <div class="grid grid-cols-3 gap-2">
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">PSI In</label>
                                            <input type="number" id="psi-in-LR" name="psi_in_LR" min="0" max="80" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">PSI Out</label>
                                            <input type="number" id="psi-out-LR" name="psi_out_LR" min="0" max="80" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">Tread (32nds)</label>
                                            <input type="number" id="tread-LR" name="tread_LR" min="0" max="20" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                    </div>
                                    <!-- Status Checkboxes -->
                                    <div class="flex space-x-4">
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_LR" value="pass" class="rounded border-gray-300 text-green-600 focus:ring-green-500">
                                            <span class="text-sm text-gray-700">Pass</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_LR" value="recommended" class="rounded border-gray-300 text-yellow-600 focus:ring-yellow-500">
                                            <span class="text-sm text-gray-700">Recommended</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_LR" value="fail" class="rounded border-gray-300 text-red-600 focus:ring-red-500">
                                            <span class="text-sm text-gray-700">Fail</span>
                                        </label>
                                    </div>
                                </div>
                                <!-- Conditions -->
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700">Conditions / Observations</label>
                                    <div class="grid grid-cols-2 gap-2 text-xs">
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LR_even_wear" name="cond_LR_even_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Even wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LR_inner_wear" name="cond_LR_inner_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Inner wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LR_outer_wear" name="cond_LR_outer_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Outer wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LR_center_wear" name="cond_LR_center_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Center wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LR_cupping" name="cond_LR_cupping" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Cupping</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LR_sidewall_damage" name="cond_LR_sidewall_damage" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Sidewall damage</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LR_cracking" name="cond_LR_cracking" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Cracking</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_LR_puncture" name="cond_LR_puncture" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Puncture</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right Rear Tire -->
                        <div class="border border-gray-300 rounded-lg p-4">
                            <h4 class="font-medium text-gray-800 mb-3">Right Rear Tire</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Measurements -->
                                <div class="space-y-3">
                                    <div class="grid grid-cols-3 gap-2">
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">PSI In</label>
                                            <input type="number" id="psi-in-RR" name="psi_in_RR" min="0" max="80" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">PSI Out</label>
                                            <input type="number" id="psi-out-RR" name="psi_out_RR" min="0" max="80" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">Tread (32nds)</label>
                                            <input type="number" id="tread-RR" name="tread_RR" min="0" max="20" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                    </div>
                                    <!-- Status Checkboxes -->
                                    <div class="flex space-x-4">
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_RR" value="pass" class="rounded border-gray-300 text-green-600 focus:ring-green-500">
                                            <span class="text-sm text-gray-700">Pass</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_RR" value="recommended" class="rounded border-gray-300 text-yellow-600 focus:ring-yellow-500">
                                            <span class="text-sm text-gray-700">Recommended</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_RR" value="fail" class="rounded border-gray-300 text-red-600 focus:ring-red-500">
                                            <span class="text-sm text-gray-700">Fail</span>
                                        </label>
                                    </div>
                                </div>
                                <!-- Conditions -->
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700">Conditions / Observations</label>
                                    <div class="grid grid-cols-2 gap-2 text-xs">
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RR_even_wear" name="cond_RR_even_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Even wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RR_inner_wear" name="cond_RR_inner_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Inner wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RR_outer_wear" name="cond_RR_outer_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Outer wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RR_center_wear" name="cond_RR_center_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Center wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RR_cupping" name="cond_RR_cupping" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Cupping</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RR_sidewall_damage" name="cond_RR_sidewall_damage" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Sidewall damage</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RR_cracking" name="cond_RR_cracking" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Cracking</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_RR_puncture" name="cond_RR_puncture" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Puncture</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Spare Tire -->
                        <div class="border border-gray-300 rounded-lg p-4">
                            <h4 class="font-medium text-gray-800 mb-3">Spare Tire</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Measurements -->
                                <div class="space-y-3">
                                    <div class="grid grid-cols-3 gap-2">
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">PSI In</label>
                                            <input type="number" id="psi-in-SPARE" name="psi_in_SPARE" min="0" max="80" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">PSI Out</label>
                                            <input type="number" id="psi-out-SPARE" name="psi_out_SPARE" min="0" max="80" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-gray-600">Tread (32nds)</label>
                                            <input type="number" id="tread-SPARE" name="tread_SPARE" min="0" max="20" step="0.5"
                                                   class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500">
                                        </div>
                                    </div>
                                    <!-- Status Checkboxes -->
                                    <div class="flex space-x-4">
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_SPARE" value="pass" class="rounded border-gray-300 text-green-600 focus:ring-green-500">
                                            <span class="text-sm text-gray-700">Pass</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_SPARE" value="recommended" class="rounded border-gray-300 text-yellow-600 focus:ring-yellow-500">
                                            <span class="text-sm text-gray-700">Recommended</span>
                                        </label>
                                        <label class="flex items-center space-x-2">
                                            <input type="radio" name="status_SPARE" value="fail" class="rounded border-gray-300 text-red-600 focus:ring-red-500">
                                            <span class="text-sm text-gray-700">Fail</span>
                                        </label>
                                    </div>
                                </div>
                                <!-- Conditions -->
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700">Conditions / Observations</label>
                                    <div class="grid grid-cols-2 gap-2 text-xs">
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_SPARE_even_wear" name="cond_SPARE_even_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Even wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_SPARE_inner_wear" name="cond_SPARE_inner_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Inner wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_SPARE_outer_wear" name="cond_SPARE_outer_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Outer wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_SPARE_center_wear" name="cond_SPARE_center_wear" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Center wear</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_SPARE_cupping" name="cond_SPARE_cupping" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Cupping</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_SPARE_sidewall_damage" name="cond_SPARE_sidewall_damage" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Sidewall damage</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_SPARE_cracking" name="cond_SPARE_cracking" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Cracking</span>
                                        </label>
                                        <label class="flex items-center space-x-1">
                                            <input type="checkbox" id="cond_SPARE_puncture" name="cond_SPARE_puncture" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-gray-700">Puncture</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Work Recommendations -->
                    <div class="mt-6 border border-gray-300 rounded-lg p-4">
                        <h4 class="font-medium text-gray-800 mb-3">Work Recommendations</h4>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="rotation" name="rotation" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="text-sm text-gray-700">Rotation</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="balance" name="balance" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="text-sm text-gray-700">Balance</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="maintenance" name="maintenance" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="text-sm text-gray-700">Maintenance</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="tire-wear-concern" name="tire_wear_concern" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="text-sm text-gray-700">Tire Wear</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Alignment Check -->
                    <div class="mt-6 border border-gray-300 rounded-lg p-4">
                        <h4 class="font-medium text-gray-800 mb-3">Alignment Check</h4>
                        <div class="flex space-x-6">
                            <label class="flex items-center space-x-2">
                                <input type="radio" name="alignment_check" value="pass" class="rounded border-gray-300 text-green-600 focus:ring-green-500">
                                <span class="text-sm text-gray-700">Pass</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="radio" name="alignment_check" value="recommended" class="rounded border-gray-300 text-yellow-600 focus:ring-yellow-500">
                                <span class="text-sm text-gray-700">Recommended</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="radio" name="alignment_check" value="fail" class="rounded border-gray-300 text-red-600 focus:ring-red-500">
                                <span class="text-sm text-gray-700">Fail</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Section Status Indicator -->
                    <div class="mt-4 flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <span class="text-sm font-medium text-gray-700">Section Status:</span>
                            <div id="section-status-indicator" class="w-6 h-6 bg-green-500 rounded-full border-2 border-gray-300"></div>
                            <span id="section-status-text" class="text-sm text-gray-700">Pass</span>
                        </div>
                        <div id="save-indicator" class="text-sm text-green-600 opacity-0 transition-opacity duration-300">
                            ✓ Saved
                        </div>
                    </div>
                </div>
            `;
        }

        function showStep(stepIndex) {
            // Hide all steps
            document.querySelectorAll('.step-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Show selected step
            const stepContent = document.getElementById(`step-${stepIndex}`);
            if (stepContent) {
                stepContent.style.display = 'block';
                currentStep = stepIndex;
            }
            
            // Update navigation
            document.querySelectorAll('#steps-nav button').forEach((btn, index) => {
                btn.classList.remove('btn-primary');
                btn.classList.add('btn-outline-primary');
                if (index === stepIndex) {
                    btn.classList.remove('btn-outline-primary');
                    btn.classList.add('btn-primary');
                }
            });
            
            updateProgress();
        }

        function updateProgress() {
            const totalItems = document.querySelectorAll('.item-row').length;
            const completedItems = document.querySelectorAll('.status-checkbox:checked').length;
            const percentage = totalItems > 0 ? Math.round((completedItems / totalItems) * 100) : 0;
            
            document.getElementById('progress-bar').style.width = percentage + '%';
            document.getElementById('progress-text').textContent = `${percentage}% Complete`;
        }

        function getSelectedStatus(row) {
            const statusCheckbox = row.querySelector('.status-checkbox:checked');
            return statusCheckbox ? statusCheckbox.value : '';
        }

        function setupEventListeners() {
            // Status checkbox change
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('status-checkbox')) {
                    updateProgress();
                    updateFinalizeButtonState();
                }
            });

            // Inspector fields
            document.getElementById('inspector_name').addEventListener('input', function() {
                inspectionData.inspector_name = this.value;
                // Clear validation error when user starts typing
                if (this.value.trim().length > 0) {
                    hideValidationError();
                    highlightField('inspector_name', true);
                }
                updateFinalizeButtonState();
            });

            document.getElementById('inspector_id').addEventListener('input', function() {
                inspectionData.inspector_id = this.value;
                // Clear validation error when user starts typing
                if (this.value.trim().length > 0) {
                    hideValidationError();
                    highlightField('inspector_id', true);
                }
                updateFinalizeButtonState();
            });

            document.getElementById('inspection_title').addEventListener('input', function() {
                inspectionData.title = this.value;
                // Clear validation error when user starts typing
                if (this.value.trim().length > 0) {
                    hideValidationError();
                    highlightField('inspection_title', true);
                }
            });

            // VIN decode button
            document.getElementById('decode-vin').addEventListener('click', decodeVIN);
            
            // Auto-decode VIN when user finishes typing (with debounce)
            let vinDecodeTimeout;
            document.getElementById('vin').addEventListener('input', function() {
                clearTimeout(vinDecodeTimeout);
                const vin = this.value.trim();
                inspectionData.vin = vin;
                
                // Clear validation error when user starts typing
                if (vin.length > 0) {
                    hideValidationError();
                    highlightField('vin', true);
                }
                
                if (vin.length >= 17) {
                    vinDecodeTimeout = setTimeout(() => {
                        decodeVIN();
                    }, 1000); // Wait 1 second after user stops typing
                }
            });

            // Save button
            document.getElementById('save-inspection').addEventListener('click', saveInspection);
            
            // Save Draft button
            document.getElementById('save-draft').addEventListener('click', saveDraft);

            // Finalize button
            document.getElementById('finalize-inspection').addEventListener('click', finalizeInspection);
            
            
        }

        async function createInspection() {
            try {
                const result = await window.apiClient.createInspectionLegacy({
                    title: inspectionData.title || 'Vehicle Inspection',
                    industry_type: 'automotive',
                    industry_info: {
                        industry_type: 'automotive',
                        facility_name: '',
                        location: '',
                        contact_person: '',
                        phone: '',
                        email: ''
                    },
                    inspector_name: inspectionData.inspector_name || 'Inspector',
                    inspector_id: inspectionData.inspector_id || 'TECH001',
                    vehicle_info: {
                        vin: inspectionData.vin
                    }
                });

                if (result && result.inspection_id) {
                    inspectionId = result.inspection_id;
                    inspectionData.id = inspectionId;
                    document.getElementById('inspection-id').value = inspectionId;
                    console.log('Inspection created:', inspectionId);
                } else {
                    showValidationError('Failed to create inspection - no inspection ID returned');
                    console.error('Failed to create inspection - no inspection ID returned');
                }
            } catch (error) {
                console.error('Error creating inspection:', error);
                // Error handler will show the toast notification
            }
        }

        async function loadExistingInspection(inspectionId) {
            try {
                const inspection = await window.apiClient.getInspectionLegacy(inspectionId);
                if (inspection) {
                    // Set the inspection ID
                    inspectionId = inspection.id;
                    inspectionData = { ...inspection };
                    document.getElementById('inspection-id').value = inspectionId;
                    
                    // Populate form fields
                    if (inspection.title) {
                        document.getElementById('inspection_title').value = inspection.title;
                        inspectionData.title = inspection.title;
                    }
                    
                    if (inspection.inspector_name) {
                        document.getElementById('inspector_name').value = inspection.inspector_name;
                        inspectionData.inspector_name = inspection.inspector_name;
                    }
                    
                    if (inspection.inspector_id) {
                        document.getElementById('inspector_id').value = inspection.inspector_id;
                        inspectionData.inspector_id = inspection.inspector_id;
                    }
                    
                    if (inspection.vin) {
                        document.getElementById('vin').value = inspection.vin;
                        inspectionData.vin = inspection.vin;
                    }
                    
                    // Load vehicle info if available
                    if (inspection.vehicle_info) {
                        inspectionData.vehicle_info = inspection.vehicle_info;
                        displayVehicleInfo(inspection.vehicle_info);
                    }
                    
                    // Load categories data
                    if (inspection.categories && inspection.categories.length > 0) {
                        loadCategoriesData(inspection.categories);
                    }
                    
                    // Update status
                    if (inspection.status) {
                        updateStatus(inspection.status);
                    }
                    
                    console.log('Existing inspection loaded:', inspectionId);
                } else {
                    console.error('Failed to load inspection - no data returned');
                    // Fallback to creating new inspection
                    createInspection();
                }
            } catch (error) {
                console.error('Error loading existing inspection:', error);
                // Fallback to creating new inspection
                createInspection();
            }
        }

        function loadCategoriesData(categories) {
            categories.forEach(category => {
                category.items.forEach(item => {
                    // Find the corresponding row in the DOM
                    const row = document.querySelector(`[data-item="${item.name}"]`);
                    if (row) {
                        // Set status
                        const statusCheckbox = row.querySelector(`input[value="${item.grade}"]`);
                        if (statusCheckbox && item.grade) {
                            statusCheckbox.checked = true;
                        }
                        
                        // Set notes
                        const notesInput = row.querySelector('.notes-input');
                        if (notesInput && item.notes) {
                            notesInput.value = item.notes;
                        }
                        
                        // Set photos if available
                        if (item.photos && item.photos.length > 0) {
                            const photoContainer = row.querySelector('.photo-btn').nextElementSibling;
                            if (photoContainer) {
                                const img = document.createElement('img');
                                img.src = item.photos[0];
                                img.className = 'photo-preview mt-2';
                                img.alt = 'Uploaded photo';
                                photoContainer.appendChild(img);
                            }
                        }
                    }
                });
            });
        }

        function displayVehicleInfo(vehicleInfo) {
            const vehicleInfoDiv = document.getElementById('vehicle-info');
            const vehicleDetailsDiv = document.getElementById('vehicle-details');
            
            if (vehicleInfo && vehicleInfo.vin) {
                let details = `<div class="vehicle-info-item"><strong>VIN:</strong> ${vehicleInfo.vin}</div>`;
                
                if (vehicleInfo.year) details += `<div class="vehicle-info-item"><strong>Year:</strong> ${vehicleInfo.year}</div>`;
                if (vehicleInfo.make) details += `<div class="vehicle-info-item"><strong>Make:</strong> ${vehicleInfo.make}</div>`;
                if (vehicleInfo.model) details += `<div class="vehicle-info-item"><strong>Model:</strong> ${vehicleInfo.model}</div>`;
                if (vehicleInfo.trim) details += `<div class="vehicle-info-item"><strong>Trim:</strong> ${vehicleInfo.trim}</div>`;
                if (vehicleInfo.engine) details += `<div class="vehicle-info-item"><strong>Engine:</strong> ${vehicleInfo.engine}</div>`;
                if (vehicleInfo.transmission) details += `<div class="vehicle-info-item"><strong>Transmission:</strong> ${vehicleInfo.transmission}</div>`;
                if (vehicleInfo.body_style) details += `<div class="vehicle-info-item"><strong>Body Style:</strong> ${vehicleInfo.body_style}</div>`;
                if (vehicleInfo.fuel_type) details += `<div class="vehicle-info-item"><strong>Fuel Type:</strong> ${vehicleInfo.fuel_type}</div>`;
                if (vehicleInfo.drivetrain) details += `<div class="vehicle-info-item"><strong>Drivetrain:</strong> ${vehicleInfo.drivetrain}</div>`;
                
                vehicleDetailsDiv.innerHTML = details;
                vehicleInfoDiv.style.display = 'block';
            }
        }

        async function createInspectionWithVINData(vehicleData) {
            try {
                // If inspection already exists, update it with VIN data
                if (inspectionId) {
                    const result = await window.apiClient.updateInspectionLegacy(inspectionId, {
                        ...inspectionData,
                        vehicle_info: {
                            vin: inspectionData.vin,
                            year: vehicleData.year,
                            make: vehicleData.make,
                            model: vehicleData.model,
                            trim: vehicleData.trim,
                            engine: vehicleData.engine_displacement,
                            transmission: vehicleData.transmission_type,
                            body_style: vehicleData.body_style,
                            fuel_type: vehicleData.fuel_type,
                            drivetrain: vehicleData.drivetrain,
                            country_of_origin: vehicleData.country_of_origin,
                            plant_code: vehicleData.plant_code,
                            serial_number: vehicleData.serial_number
                        }
                    });

                    if (result) {
                        console.log('Inspection updated with VIN data');
                    } else {
                        console.error('Failed to update inspection with VIN data');
                    }
                } else {
                    // Create new inspection with VIN data
                    const result = await window.apiClient.createInspectionLegacy({
                        title: inspectionData.title || 'Vehicle Inspection',
                        industry_type: 'automotive',
                        industry_info: {
                            industry_type: 'automotive',
                            facility_name: '',
                            location: '',
                            contact_person: '',
                            phone: '',
                            email: ''
                        },
                        inspector_name: inspectionData.inspector_name || 'Inspector',
                        inspector_id: inspectionData.inspector_id || 'TECH001',
                        vehicle_info: {
                            vin: inspectionData.vin,
                            year: vehicleData.year,
                            make: vehicleData.make,
                            model: vehicleData.model,
                            trim: vehicleData.trim,
                            engine: vehicleData.engine_displacement,
                            transmission: vehicleData.transmission_type,
                            body_style: vehicleData.body_style,
                            fuel_type: vehicleData.fuel_type,
                            drivetrain: vehicleData.drivetrain,
                            country_of_origin: vehicleData.country_of_origin,
                            plant_code: vehicleData.plant_code,
                            serial_number: vehicleData.serial_number
                        }
                    });

                    if (result && result.inspection_id) {
                        inspectionId = result.inspection_id;
                        inspectionData.id = inspectionId;
                        document.getElementById('inspection-id').value = inspectionId;
                        console.log('Inspection created with VIN data:', inspectionId);
                    } else {
                        console.error('Failed to create inspection with VIN data');
                    }
                }
            } catch (error) {
                console.error('Error creating/updating inspection with VIN data:', error);
            }
        }

        async function decodeVIN() {
            const vin = document.getElementById('vin').value.trim();
            if (!vin) {
                alert('Please enter a VIN number');
                return;
            }

            // Performance timing for VIN decode
            performance.mark('vin-decode-start');

            try {
                // Use the API client with error handling
                const vehicleData = await window.apiClient.decodeVIN(vin);
                if (vehicleData) {
                    displayVehicleInfo(vehicleData);
                    inspectionData.vin = vin;
                    
                    // Create or update inspection with VIN data
                    await createInspectionWithVINData(vehicleData);
                    
                    // Performance timing for VIN decode completion
                    performance.mark('vin-decode-end');
                    performance.measure('vin-decode-total', 'vin-decode-start', 'vin-decode-end');
                    
                    const measure = performance.getEntriesByName('vin-decode-total')[0];
                    console.log(`VIN decode completed in ${measure.duration.toFixed(2)}ms`);
                } else {
                    console.error('VIN decode returned null or empty data');
                    alert('Failed to decode VIN - no data returned');
                }
            } catch (error) {
                console.error('Error decoding VIN:', error);
                // Error handler will show the toast notification
            }
        }

        function openPhotoModal(step, subcategory, item) {
            currentPhotoItem = { step, subcategory, item };
            const modal = new bootstrap.Modal(document.getElementById('photoModal'));
            modal.show();
        }

        async function uploadPhoto() {
            if (!currentPhotoItem) return;

            const fileInput = document.getElementById('photo-file');
            const cameraInput = document.getElementById('camera-input');
            
            let file = fileInput.files[0] || cameraInput.files[0];
            if (!file) {
                alert('Please select a photo');
                return;
            }

            try {
                const result = await window.apiClient.uploadPhotoLegacy(inspectionId, file, currentPhotoItem.step, currentPhotoItem.item);
                
                if (result) {
                    // Close modal using Bootstrap API
                    const modal = bootstrap.Modal.getInstance(document.getElementById('photoModal'));
                    modal.hide();
                    
                    // Update the UI to show the uploaded photo
                    updatePhotoDisplay(currentPhotoItem.step, currentPhotoItem.subcategory, currentPhotoItem.item, result.photo_url || result.filename);
                    
                    alert('Photo uploaded successfully');
                } else {
                    alert('Failed to upload photo - no response data');
                }
            } catch (error) {
                console.error('Error uploading photo:', error);
                // Error handler will show the toast notification
            }
        }

        function updatePhotoDisplay(step, subcategory, item, photoUrl) {
            // Find the correct item row and update its photo display
            const itemRows = document.querySelectorAll('.item-row');
            itemRows.forEach(row => {
                if (row.dataset.step === step && 
                    row.dataset.subcategory === subcategory && 
                    row.dataset.item === item) {
                    
                    const photoContainer = row.querySelector('.photo-btn').nextElementSibling;
                    if (photoContainer) {
                        // Ensure the photo URL is correct
                        let displayUrl = photoUrl;
                        if (!photoUrl.startsWith('/') && !photoUrl.startsWith('http')) {
                            displayUrl = `/static/uploads/inspections/${photoUrl}`;
                        } else if (photoUrl.startsWith('/static/uploads/') && !photoUrl.includes('/inspections/')) {
                            // Fix legacy URLs to use the correct path
                            displayUrl = photoUrl.replace('/static/uploads/', '/static/uploads/inspections/');
                        }
                        
                        photoContainer.innerHTML = `
                            <img src="${displayUrl}" 
                                 class="img-thumbnail" style="max-width: 50px; max-height: 50px;" 
                                 alt="Uploaded photo"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="text-muted small" style="display: none;">Photo uploaded</div>
                        `;
                        
                        // Also update the photo button to show it's been used
                        const photoBtn = row.querySelector('.photo-btn');
                        if (photoBtn) {
                            photoBtn.classList.add('btn-success');
                            photoBtn.classList.remove('btn-outline-primary');
                            photoBtn.innerHTML = '<i class="fas fa-camera"></i> Photo Added';
                        }
                    }
                }
            });
        }

        function loadExistingPhotos() {
            // Load existing photos from inspection data
            if (inspectionData) {
                if (inspectionData.categories) {
                    // Old structure with categories
                    inspectionData.categories.forEach(category => {
                        category.items.forEach(item => {
                            if (item.photo_url) {
                                updatePhotoDisplay(category.name, category.name, item.name, item.photo_url);
                            }
                        });
                    });
                } else if (inspectionData.items) {
                    // New structure with items array
                    inspectionData.items.forEach(item => {
                        if (item.photo_url) {
                            updatePhotoDisplay(item.step, item.subcategory, item.item, item.photo_url);
                        }
                    });
                }
            }
        }

        // Validation helper functions
        function showValidationError(message) {
            const container = document.getElementById('validation-error-container');
            const messageSpan = document.getElementById('validation-error-message');
            messageSpan.textContent = message;
            container.style.display = 'block';
            container.classList.remove('d-none');
        }

        function hideValidationError() {
            const container = document.getElementById('validation-error-container');
            container.style.display = 'none';
            container.classList.add('d-none');
        }

        function highlightField(fieldId, isValid) {
            const field = document.getElementById(fieldId);
            if (field) {
                if (!isValid) {
                    field.classList.add('field-error');
                    field.setAttribute('aria-invalid', 'true');
                } else {
                    field.classList.remove('field-error');
                    field.setAttribute('aria-invalid', 'false');
                }
            }
        }

        function validateForm() {
            let isValid = true;
            let errorMessages = [];

            // Validate inspector name
            const inspectorName = inspectionData.inspector_name.trim();
            if (!inspectorName) {
                errorMessages.push('Inspector name is required');
                highlightField('inspector_name', false);
                isValid = false;
            } else {
                highlightField('inspector_name', true);
            }

            // Validate inspector ID
            const inspectorId = inspectionData.inspector_id.trim();
            if (!inspectorId) {
                errorMessages.push('Inspector ID is required');
                highlightField('inspector_id', false);
                isValid = false;
            } else {
                highlightField('inspector_id', true);
            }

            // Validate inspection title
            const title = inspectionData.title.trim();
            if (!title) {
                errorMessages.push('Inspection title is required');
                highlightField('inspection_title', false);
                isValid = false;
            } else {
                highlightField('inspection_title', true);
            }

            // Validate VIN if provided
            const vin = inspectionData.vin.trim();
            if (vin && vin.length !== 17) {
                errorMessages.push('VIN must be exactly 17 characters');
                highlightField('vin', false);
                isValid = false;
            } else if (vin) {
                highlightField('vin', true);
            }

            if (!isValid) {
                showValidationError(errorMessages.join('; '));
            } else {
                hideValidationError();
            }

            return isValid;
        }

        function updateFinalizeButtonState() {
            const finalizeButton = document.getElementById('finalize-inspection');
            const isFormValid = validateForm();
            const hasCompletedItems = hasAllItemsCompleted();
            
            if (isFormValid && hasCompletedItems && inspectionData.status !== 'finalized') {
                finalizeButton.disabled = false;
                finalizeButton.classList.remove('btn-secondary');
                finalizeButton.classList.add('btn-warning');
            } else {
                finalizeButton.disabled = true;
                finalizeButton.classList.remove('btn-warning');
                finalizeButton.classList.add('btn-secondary');
            }
        }

        function hasAllItemsCompleted() {
            const statusCheckboxes = document.querySelectorAll('.status-checkbox:checked');
            const totalItems = document.querySelectorAll('.item-row').length;
            
            return totalItems > 0 && statusCheckboxes.length === totalItems;
        }

        async function finalizeInspection() {
            // Performance timing for finalize operation
            performance.mark('finalize-inspection-start');
            
            // Clear previous validation errors
            hideValidationError();
            
            // Validate required fields
            if (!validateForm()) {
                return;
            }

            // Validate that all items are completed
            if (!hasAllItemsCompleted()) {
                showValidationError('All inspection items must be completed before finalizing.');
                return;
            }

            if (!inspectionId) {
                // Try to create inspection if it doesn't exist
                try {
                    await createInspection();
                    if (!inspectionId) {
                        showValidationError('Failed to create inspection. Please try again.');
                        return;
                    }
                } catch (error) {
                    console.error('Error creating inspection:', error);
                    showValidationError('Failed to create inspection. Please try again.');
                    return;
                }
            }

            // Save current state before finalizing (without redirect)
            const saveSuccess = await saveInspectionWithoutRedirect();
            if (!saveSuccess) {
                return; // Stop if save failed
            }

            try {
                const result = await window.apiClient.finalizeInspection(inspectionId);
                
                if (result) {
                    // Update local inspection data
                    inspectionData.status = 'finalized';
                    inspectionData.finalized_at = result.metadata.finalized_at;
                    
                    // Update UI to show finalized state
                    updateInspectionStatus('Finalized');
                    disableFormEditing();
                    
                    // Show success message with summary
                    const summary = result.summary;
                    const message = `Inspection finalized successfully!\n\nSummary:\n` +
                        `• Total Items: ${summary.total_items}\n` +
                        `• Pass: ${summary.pass_count}\n` +
                        `• Recommended: ${summary.recommended_count}\n` +
                        `• Required: ${summary.required_count}\n` +
                        `• Completion: ${summary.completion_percentage}%`;
                    
                    alert(message);
                    
                    // Performance timing for finalize completion
                    performance.mark('finalize-inspection-end');
                    performance.measure('finalize-inspection-total', 'finalize-inspection-start', 'finalize-inspection-end');
                    
                    const measure = performance.getEntriesByName('finalize-inspection-total')[0];
                    console.log(`Inspection finalize completed in ${measure.duration.toFixed(2)}ms`);
                    
                    // Update finalize button
                    const finalizeButton = document.getElementById('finalize-inspection');
                    finalizeButton.disabled = true;
                    finalizeButton.classList.remove('btn-warning');
                    finalizeButton.classList.add('btn-success');
                    finalizeButton.innerHTML = '<i class="fas fa-check"></i> Finalized';
                    
                } else {
                    showValidationError('Failed to finalize inspection - no response data');
                    console.error('Failed to finalize inspection - no response data');
                }
            } catch (error) {
                console.error('Error finalizing inspection:', error);
                // Error handler will show the toast notification
            }
        }

        function updateInspectionStatus(status) {
            const statusText = document.getElementById('status-text');
            const statusContainer = document.getElementById('inspection-status');
            
            statusText.textContent = status;
            
            if (status === 'Finalized') {
                statusContainer.className = 'alert alert-success';
                statusContainer.innerHTML = '<i class="fas fa-check-circle"></i> Status: <span id="status-text">Finalized</span>';
            } else {
                statusContainer.className = 'alert alert-info';
                statusContainer.innerHTML = '<i class="fas fa-info-circle"></i> Status: <span id="status-text">' + status + '</span>';
            }
        }

        function disableFormEditing() {
            // Disable all form inputs
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                input.disabled = true;
            });
            
            // Disable photo upload buttons
            const photoButtons = document.querySelectorAll('.photo-btn');
            photoButtons.forEach(button => {
                button.disabled = true;
                button.classList.add('btn-secondary');
                button.classList.remove('btn-outline-secondary');
            });
            
            // Disable save button
            const saveButton = document.getElementById('save-inspection');
            saveButton.disabled = true;
            saveButton.classList.add('btn-secondary');
            saveButton.classList.remove('btn-success');
        }

        async function saveInspectionWithoutRedirect() {
            // Clear previous validation errors
            hideValidationError();
            
            // Validate required fields
            if (!validateForm()) {
                return false;
            }

            if (!inspectionId) {
                // Try to create inspection if it doesn't exist
                try {
                    await createInspection();
                    if (!inspectionId) {
                        showValidationError('Failed to create inspection. Please try again.');
                        return false;
                    }
                } catch (error) {
                    console.error('Error creating inspection:', error);
                    showValidationError('Failed to create inspection. Please try again.');
                    return false;
                }
            }

            // Collect all inspection data and transform to categories format
            const categories = [];
            const steps = Object.entries(inspectionTemplate.inspection_points);
            
            steps.forEach(([key, stepData]) => {
                const category = {
                    name: stepData.description,
                    description: stepData.description,
                    items: []
                };

                // Check if this step has subsections (like Steering & Suspension)
                if (stepData.subcategories) {
                    // Handle subsections structure
                    Object.entries(stepData.subcategories).forEach(([subKey, subcategory]) => {
                        subcategory.items.forEach(itemName => {
                            // Find the corresponding row in the DOM
                            const row = document.querySelector(`[data-item="${itemName}"]`);
                            if (row) {
                                const status = getSelectedStatus(row);
                                const notes = row.querySelector('.notes-input').value;
                                const photoContainer = row.querySelector('.photo-btn').nextElementSibling;
                                const photoImg = photoContainer.querySelector('img');
                                const photo_url = photoImg ? photoImg.src : null;

                                category.items.push({
                                    name: itemName,
                                    grade: status || 'N/A',
                                    notes: notes,
                                    photos: photo_url ? [photo_url] : []
                                });
                            }
                        });
                    });
                } else {
                    // Legacy format - handle items directly
                    stepData.items.forEach(itemName => {
                        // Find the corresponding row in the DOM
                        const row = document.querySelector(`[data-item="${itemName}"]`);
                        if (row) {
                            const status = getSelectedStatus(row);
                            const notes = row.querySelector('.notes-input').value;
                            const photoContainer = row.querySelector('.photo-btn').nextElementSibling;
                            const photoImg = photoContainer.querySelector('img');
                            const photo_url = photoImg ? photoImg.src : null;

                            category.items.push({
                                name: itemName,
                                grade: status || 'N/A',
                                notes: notes,
                                photos: photo_url ? [photo_url] : []
                            });
                        }
                    });
                }

                categories.push(category);
            });

            // Update inspection data with categories format
            inspectionData.categories = categories;
            inspectionData.date = new Date().toISOString();

            try {
                const response = await fetch(`/api/inspections/${inspectionId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(inspectionData)
                });

                if (response.ok) {
                    const result = await response.json();
                    hideValidationError();
                    return true;
                } else {
                    const errorData = await response.json();
                    let errorMessage = 'Failed to save inspection';
                    
                    // Handle validation errors from server
                    if (response.status === 422) {
                        if (errorData.detail && Array.isArray(errorData.detail)) {
                            const validationErrors = errorData.detail.map(err => 
                                `${err.loc ? err.loc.join('.') + ': ' : ''}${err.msg}`
                            );
                            errorMessage = validationErrors.join('; ');
                        } else if (errorData.detail) {
                            errorMessage = errorData.detail;
                        }
                    } else if (errorData.detail) {
                        errorMessage = errorData.detail;
                    }
                    
                    showValidationError(errorMessage);
                    return false;
                }
            } catch (error) {
                console.error('Error saving inspection:', error);
                showValidationError('Network error: Unable to save inspection. Please check your connection and try again.');
                return false;
            }
        }

        async function saveInspection() {
            // Performance timing for save operation
            performance.mark('save-inspection-start');
            
            // Clear previous validation errors
            hideValidationError();
            
            // Validate required fields
            if (!validateForm()) {
                return;
            }

            if (!inspectionId) {
                // Try to create inspection if it doesn't exist
                try {
                    await createInspection();
                    if (!inspectionId) {
                        showValidationError('Failed to create inspection. Please try again.');
                        return;
                    }
                } catch (error) {
                    console.error('Error creating inspection:', error);
                    showValidationError('Failed to create inspection. Please try again.');
                    return;
                }
            }

            // Collect all inspection data and transform to categories format
            const categories = [];
            const steps = Object.entries(inspectionTemplate.inspection_points);
            
            steps.forEach(([key, stepData]) => {
                const category = {
                    name: stepData.description,
                    description: stepData.description,
                    items: []
                };

                // Check if this step has subsections (like Steering & Suspension)
                if (stepData.subcategories) {
                    // Handle subsections structure
                    Object.entries(stepData.subcategories).forEach(([subKey, subcategory]) => {
                        subcategory.items.forEach(itemName => {
                            // Find the corresponding row in the DOM
                            const row = document.querySelector(`[data-item="${itemName}"]`);
                            if (row) {
                                const status = getSelectedStatus(row);
                                const notes = row.querySelector('.notes-input').value;
                                const photoContainer = row.querySelector('.photo-btn').nextElementSibling;
                                const photoImg = photoContainer.querySelector('img');
                                const photo_url = photoImg ? photoImg.src : null;

                                category.items.push({
                                    name: itemName,
                                    grade: status || 'N/A',
                                    notes: notes,
                                    photos: photo_url ? [photo_url] : []
                                });
                            }
                        });
                    });
                } else {
                    // Legacy format - handle items directly
                    stepData.items.forEach(itemName => {
                        // Find the corresponding row in the DOM
                        const row = document.querySelector(`[data-item="${itemName}"]`);
                        if (row) {
                            const status = getSelectedStatus(row);
                            const notes = row.querySelector('.notes-input').value;
                            const photoContainer = row.querySelector('.photo-btn').nextElementSibling;
                            const photoImg = photoContainer.querySelector('img');
                            const photo_url = photoImg ? photoImg.src : null;

                            category.items.push({
                                name: itemName,
                                grade: status || 'N/A',
                                notes: notes,
                                photos: photo_url ? [photo_url] : []
                            });
                        }
                    });
                }

                categories.push(category);
            });

            // Update inspection data with categories format
            inspectionData.categories = categories;
            inspectionData.date = new Date().toISOString();

            try {
                const response = await fetch(`/api/inspections/${inspectionId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(inspectionData)
                });

                if (response.ok) {
                    const result = await response.json();
                    hideValidationError();
                    
                    // Performance timing for save completion
                    performance.mark('save-inspection-end');
                    performance.measure('save-inspection-total', 'save-inspection-start', 'save-inspection-end');
                    
                    const measure = performance.getEntriesByName('save-inspection-total')[0];
                    console.log(`Inspection save completed in ${measure.duration.toFixed(2)}ms`);
                    
                    alert('Inspection saved successfully!');
                    window.location.href = '/inspections';
                } else {
                    const errorData = await response.json();
                    let errorMessage = 'Failed to save inspection';
                    
                    // Handle validation errors from server
                    if (response.status === 422) {
                        if (errorData.detail && Array.isArray(errorData.detail)) {
                            const validationErrors = errorData.detail.map(err => 
                                `${err.loc ? err.loc.join('.') + ': ' : ''}${err.msg}`
                            );
                            errorMessage = validationErrors.join('; ');
                        } else if (errorData.detail) {
                            errorMessage = errorData.detail;
                        }
                    } else if (errorData.detail) {
                        errorMessage = errorData.detail;
                    }
                    
                    showValidationError(errorMessage);
                }
            } catch (error) {
                console.error('Error saving inspection:', error);
                showValidationError('Network error: Unable to save inspection. Please check your connection and try again.');
            }
        }

        async function saveDraft() {
            // Collect current form data without validation
            const draftData = {
                title: document.getElementById('inspection_title').value || '',
                inspector_name: document.getElementById('inspector_name').value || '',
                inspector_id: document.getElementById('inspector_id').value || '',
                vin: document.getElementById('vin').value || '',
                vehicle_info: inspectionData.vehicle_info || null,
                categories: [],
                status: 'draft',
                updated_at: new Date().toISOString()
            };

            // Collect categories data
            const categories = [];
            const steps = Object.entries(inspectionTemplate.inspection_points);
            
            steps.forEach(([key, stepData]) => {
                const category = {
                    name: stepData.description,
                    description: stepData.description,
                    items: []
                };

                // Check if this step has subsections (like Steering & Suspension)
                if (stepData.subcategories) {
                    // Handle subsections structure
                    Object.entries(stepData.subcategories).forEach(([subKey, subcategory]) => {
                        subcategory.items.forEach(itemName => {
                            const row = document.querySelector(`[data-item="${itemName}"]`);
                            if (row) {
                                const status = getSelectedStatus(row);
                                const notes = row.querySelector('.notes-input').value;
                                const photoContainer = row.querySelector('.photo-btn').nextElementSibling;
                                const photoImg = photoContainer.querySelector('img');
                                const photo_url = photoImg ? photoImg.src : null;

                                category.items.push({
                                    name: itemName,
                                    grade: status || 'N/A',
                                    notes: notes,
                                    photos: photo_url ? [photo_url] : []
                                });
                            }
                        });
                    });
                } else {
                    // Legacy format - handle items directly
                    stepData.items.forEach(itemName => {
                        const row = document.querySelector(`[data-item="${itemName}"]`);
                        if (row) {
                            const status = getSelectedStatus(row);
                            const notes = row.querySelector('.notes-input').value;
                            const photoContainer = row.querySelector('.photo-btn').nextElementSibling;
                            const photoImg = photoContainer.querySelector('img');
                            const photo_url = photoImg ? photoImg.src : null;

                            category.items.push({
                                name: itemName,
                                grade: status || 'N/A',
                                notes: notes,
                                photos: photo_url ? [photo_url] : []
                            });
                        }
                    });
                }

                categories.push(category);
            });

            draftData.categories = categories;

            try {
                if (!inspectionId) {
                    // Create new inspection if it doesn't exist
                    const createResponse = await fetch('/api/inspections', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            title: draftData.title || 'Draft Inspection',
                            industry_info: {
                                name: 'Automotive',
                                type: 'automotive'
                            },
                            vehicle_info: draftData.vehicle_info,
                            inspector_name: draftData.inspector_name,
                            inspector_id: draftData.inspector_id,
                            industry_type: 'automotive'
                        })
                    });

                    if (createResponse.ok) {
                        const createResult = await createResponse.json();
                        inspectionId = createResult.inspection_id;
                        document.getElementById('inspection-id').value = inspectionId;
                    } else {
                        throw new Error('Failed to create inspection');
                    }
                }

                // Save draft using PATCH endpoint
                const response = await fetch(`/api/inspections/${inspectionId}`, {
                    method: 'PATCH',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(draftData)
                });

                if (response.ok) {
                    const result = await response.json();
                    hideValidationError();
                    alert('Draft saved successfully!');
                    updateStatus('Draft');
                } else {
                    const errorData = await response.json();
                    let errorMessage = 'Failed to save draft';
                    
                    if (errorData.detail) {
                        errorMessage = errorData.detail;
                    }
                    
                    showValidationError(errorMessage);
                }
            } catch (error) {
                console.error('Error saving draft:', error);
                showValidationError('Network error: Unable to save draft. Please check your connection and try again.');
            }
        }

        // Tire Inspection Functionality
        function setupTireInspectionHandlers() {
            // Wait for the tire section to be loaded
            setTimeout(() => {
                const tireSection = document.getElementById('tire-inspection-section');
                if (tireSection) {
                    setupTireInputHandlers();
                    setupTireStatusHandlers();
                    setupTireAutoSuggestions();
                    loadTireData();
                }
            }, 1000);
        }

        function setupTireInputHandlers() {
            // Setup debounced save for PSI and tread inputs
            const inputs = document.querySelectorAll('#tire-inspection-section input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('blur', debounce(saveTireData, 500));
            });

            // Setup save for text inputs
            const textInputs = document.querySelectorAll('#tire-inspection-section input[type="text"]');
            textInputs.forEach(input => {
                input.addEventListener('blur', debounce(saveTireData, 500));
            });

            // Setup save for checkboxes and radios
            const checkboxes = document.querySelectorAll('#tire-inspection-section input[type="checkbox"], #tire-inspection-section input[type="radio"]');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', saveTireData);
            });
        }

        function setupTireStatusHandlers() {
            // Setup traffic light radio buttons
            const statusRadios = document.querySelectorAll('#tire-inspection-section input[type="radio"]');
            statusRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    updateTireStatusDisplay(this);
                    updateSectionStatus();
                });
            });
        }

        function setupTireAutoSuggestions() {
            // Auto-suggest balance when alignment is RED
            const alignmentRadios = document.querySelectorAll('input[name="alignment_check"]');
            alignmentRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.value === 'RED') {
                        const balanceCheckbox = document.getElementById('balance');
                        if (balanceCheckbox) {
                            balanceCheckbox.checked = true;
                            saveTireData();
                        }
                    }
                });
            });

            // Auto-check tire wear and rotation for uneven wear conditions
            const wearCheckboxes = [
                'cond_inner_wear', 'cond_outer_wear', 'cond_center_wear', 
                'cond_cupping_feather'
            ];
            wearCheckboxes.forEach(id => {
                const checkbox = document.getElementById(id);
                if (checkbox) {
                    checkbox.addEventListener('change', function() {
                        if (this.checked) {
                            const tireWearCheckbox = document.getElementById('tire-wear-concern');
                            const rotationCheckbox = document.getElementById('rotation');
                            if (tireWearCheckbox) tireWearCheckbox.checked = true;
                            if (rotationCheckbox) rotationCheckbox.checked = true;
                            saveTireData();
                        }
                    });
                }
            });
        }

        function updateTireStatusDisplay(radio) {
            const div = radio.nextElementSibling;
            if (div) {
                // Remove selected state from siblings
                const siblings = radio.parentElement.parentElement.querySelectorAll('div');
                siblings.forEach(sib => {
                    sib.classList.remove('ring-2', 'ring-blue-500');
                });
                // Add selected state to current
                div.classList.add('ring-2', 'ring-blue-500');
            }
        }

        function updateSectionStatus() {
            const statusIndicator = document.getElementById('section-status-indicator');
            const statusText = document.getElementById('section-status-text');
            
            if (!statusIndicator || !statusText) return;

            // Get all status values
            const statuses = [];
            
            // Tire statuses
            ['LF', 'RF', 'LR', 'RR', 'SPARE'].forEach(pos => {
                const radio = document.querySelector(`input[name="status_${pos}"]:checked`);
                if (radio) statuses.push(radio.value);
            });
            
            // Alignment status
            const alignmentRadio = document.querySelector('input[name="alignment_check"]:checked');
            if (alignmentRadio) statuses.push(alignmentRadio.value);

            // Determine overall status (RED > YELLOW > GREEN)
            let overallStatus = 'GREEN';
            if (statuses.includes('RED')) {
                overallStatus = 'RED';
            } else if (statuses.includes('YELLOW')) {
                overallStatus = 'YELLOW';
            }

            // Update display
            statusIndicator.className = `w-6 h-6 rounded-full border-2 border-gray-300 ${
                overallStatus === 'RED' ? 'bg-red-500' : 
                overallStatus === 'YELLOW' ? 'bg-yellow-500' : 'bg-green-500'
            }`;
            statusText.textContent = overallStatus;
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function saveTireData() {
            const inspectionId = document.getElementById('inspection-id').value || 'new_inspection_' + Date.now();
            
            // Collect all tire data
            const tireData = {
                inspection_id: inspectionId,
                tire_front: document.getElementById('tire-front')?.value || '',
                tire_rear: document.getElementById('tire-rear')?.value || '',
                size_front: document.getElementById('size-front')?.value || '',
                size_rear: document.getElementById('size-rear')?.value || '',
                speed_load_front: document.getElementById('speed-load-front')?.value || '',
                speed_load_rear: document.getElementById('speed-load-rear')?.value || '',
                readings: {},
                work_rotation: document.getElementById('rotation')?.checked || false,
                work_balance: document.getElementById('balance')?.checked || false,
                work_maintenance: document.getElementById('maintenance')?.checked || false,
                work_tire_wear_concern: document.getElementById('tire-wear-concern')?.checked || false,
                alignment_check: document.querySelector('input[name="alignment_check"]:checked')?.value || 'NA',
                condition_even_wear: document.getElementById('cond_even_wear')?.checked || false,
                condition_inner_wear: document.getElementById('cond_inner_wear')?.checked || false,
                condition_outer_wear: document.getElementById('cond_outer_wear')?.checked || false,
                condition_center_wear: document.getElementById('cond_center_wear')?.checked || false,
                condition_cupping_feather: document.getElementById('cond_cupping_feather')?.checked || false,
                condition_sidewall_damage: document.getElementById('cond_sidewall_damage')?.checked || false,
                condition_cracking_dryrot: document.getElementById('cond_cracking_dryrot')?.checked || false,
                condition_puncture_object: document.getElementById('cond_puncture_object')?.checked || false,
                condition_bead_damage: document.getElementById('cond_bead_damage')?.checked || false,
                condition_cords_visible: document.getElementById('cond_cords_visible')?.checked || false,
                condition_noise_vibration: document.getElementById('cond_noise_vibration')?.checked || false,
                condition_age_over_6y: document.getElementById('cond_age_over_6y')?.checked || false
            };

            // Collect tire readings
            ['LF', 'RF', 'LR', 'RR', 'SPARE'].forEach(pos => {
                const psiIn = document.getElementById(`psi-in-${pos}`)?.value;
                const psiOut = document.getElementById(`psi-out-${pos}`)?.value;
                const tread = document.getElementById(`tread-${pos}`)?.value;
                const status = document.querySelector(`input[name="status_${pos}"]:checked`)?.value || 'NA';
                
                tireData.readings[pos] = {
                    psi_in: psiIn ? parseFloat(psiIn) : null,
                    psi_out: psiOut ? parseFloat(psiOut) : null,
                    tread_32nds: tread ? parseFloat(tread) : null,
                    status: status
                };
            });

            // Save to API
            fetch(`/api/v1/inspections/${inspectionId}/tires`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(tireData)
            })
            .then(response => response.json())
            .then(data => {
                console.log('Tire data saved:', data);
                showSaveIndicator();
            })
            .catch(error => {
                console.error('Error saving tire data:', error);
            });
        }

        function loadTireData() {
            const inspectionId = document.getElementById('inspection-id').value;
            if (!inspectionId) return;

            fetch(`/api/v1/inspections/${inspectionId}/tires`)
            .then(response => response.json())
            .then(data => {
                if (data && data.readings) {
                    // Populate form fields
                    populateTireForm(data);
                    updateSectionStatus();
                }
            })
            .catch(error => {
                console.error('Error loading tire data:', error);
            });
        }

        function populateTireForm(data) {
            // Header fields
            if (data.tire_front) document.getElementById('tire-front').value = data.tire_front;
            if (data.tire_rear) document.getElementById('tire-rear').value = data.tire_rear;
            if (data.size_front) document.getElementById('size-front').value = data.size_front;
            if (data.size_rear) document.getElementById('size-rear').value = data.size_rear;
            if (data.speed_load_front) document.getElementById('speed-load-front').value = data.speed_load_front;
            if (data.speed_load_rear) document.getElementById('speed-load-rear').value = data.speed_load_rear;

            // Work checkboxes
            if (data.work_rotation) document.getElementById('rotation').checked = data.work_rotation;
            if (data.work_balance) document.getElementById('balance').checked = data.work_balance;
            if (data.work_maintenance) document.getElementById('maintenance').checked = data.work_maintenance;
            if (data.work_tire_wear_concern) document.getElementById('tire-wear-concern').checked = data.work_tire_wear_concern;

            // Alignment check
            if (data.alignment_check) {
                const alignmentRadio = document.querySelector(`input[name="alignment_check"][value="${data.alignment_check}"]`);
                if (alignmentRadio) alignmentRadio.checked = true;
            }

            // Condition checkboxes
            const conditionFields = [
                'condition_even_wear', 'condition_inner_wear', 'condition_outer_wear', 
                'condition_center_wear', 'condition_cupping_feather', 'condition_sidewall_damage',
                'condition_cracking_dryrot', 'condition_puncture_object', 'condition_bead_damage',
                'condition_cords_visible', 'condition_noise_vibration', 'condition_age_over_6y'
            ];
            conditionFields.forEach(field => {
                if (data[field]) {
                    const checkbox = document.getElementById(field.replace('condition_', 'cond_'));
                    if (checkbox) checkbox.checked = data[field];
                }
            });

            // Tire readings
            if (data.readings) {
                Object.entries(data.readings).forEach(([pos, reading]) => {
                    if (reading.psi_in !== null) document.getElementById(`psi-in-${pos}`).value = reading.psi_in;
                    if (reading.psi_out !== null) document.getElementById(`psi-out-${pos}`).value = reading.psi_out;
                    if (reading.tread_32nds !== null) document.getElementById(`tread-${pos}`).value = reading.tread_32nds;
                    if (reading.status) {
                        const statusRadio = document.querySelector(`input[name="status_${pos}"][value="${reading.status}"]`);
                        if (statusRadio) statusRadio.checked = true;
                    }
                });
            }
        }

        function showSaveIndicator() {
            const indicator = document.getElementById('save-indicator');
            if (indicator) {
                indicator.style.opacity = '1';
                setTimeout(() => {
                    indicator.style.opacity = '0';
                }, 2000);
            }
        }

    </script>

 </body></html>